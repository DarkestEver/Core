{"version":3,"sources":["../../src/SoundFiles/one-button-sound-player.js"],"names":["sndPlayerOneBtn","slider","undefined","$pButton","$","soundSelectorClass","attr","duration","initialize","audioPlayer","after","document","getElementById","on","updateAudioSource","e","preventDefault","paused","play","html","pause","audioFileId","form","api","url","globalRootUrl","onSuccess","response","cbAfterResponse","onError","message","getElementsByTagName","src","load","oncanplaythrough","cbCanPlayThrough","cbOnSliderChange","newVal","meta","triggeredByUser","isFinite","removeEventListener","cbTimeUpdate","currentTime","addEventListener","percent","rangePosition","Math","round","$slider","range","ready"],"mappings":"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","sourcesContent":["/*\n * Copyright (C) MIKO LLC - All Rights Reserved\n * Unauthorized copying of this file, via any medium is strictly prohibited\n * Proprietary and confidential\n * Written by Nikolay Beketov, 11 2018\n *\n */\n\n/* global globalRootUrl */\n\nconst sndPlayerOneBtn = {\n\tslider: undefined, // audio player\n\t$pButton: $('.action-playback-button'), // play button\n\tsoundSelectorClass: $('.action-playback-button').attr('data-value'),\n\tduration: 0,\n\tinitialize() {\n\t\tconst audioPlayer = '<audio id=\"audio-player\" preload=\"auto\"><source src=\"\" type=\"audio/mp3\"></audio>';\n\t\tsndPlayerOneBtn.$pButton.after(audioPlayer);\n\t\tsndPlayerOneBtn.slider = document.getElementById('audio-player');\n\t\t$(`#${sndPlayerOneBtn.soundSelectorClass}`).on('change', () => {\n\t\t\tsndPlayerOneBtn.updateAudioSource();\n\t\t});\n\t\tsndPlayerOneBtn.$pButton.on('click', (e) => {\n\t\t\te.preventDefault();\n\t\t\tif (sndPlayerOneBtn.slider.paused && sndPlayerOneBtn.slider.duration) {\n\t\t\t\tsndPlayerOneBtn.slider.play();\n\t\t\t\t// remove play, add pause\n\t\t\t\tsndPlayerOneBtn.$pButton.html('<i class=\"icon pause\"></i>');\n\t\t\t} else { // pause music\n\t\t\t\tsndPlayerOneBtn.slider.pause();\n\t\t\t\t// remove pause, add play\n\t\t\t\tsndPlayerOneBtn.$pButton.html('<i class=\"icon play\"></i>');\n\t\t\t}\n\t\t});\n\t\tsndPlayerOneBtn.updateAudioSource();\n\t},\n\tupdateAudioSource() {\n\t\tconst audioFileId = $('form').form('get value', sndPlayerOneBtn.soundSelectorClass);\n\t\t$.api({\n\t\t\turl: `${globalRootUrl}sound-files/getpathbyid/${audioFileId}`,\n\t\t\ton: 'now',\n\t\t\tonSuccess(response) {\n\t\t\t\tsndPlayerOneBtn.cbAfterResponse(response);\n\t\t\t},\n\t\t\tonError() {\n\t\t\t},\n\t\t});\n\t},\n\tcbAfterResponse(response) {\n\t\tif (response.message !== undefined) {\n\t\t\tsndPlayerOneBtn.slider.getElementsByTagName('source')[0].src\n\t\t\t\t= `/pbxcore/api/cdr/playback?view=${response.message}`;\n\t\t\tsndPlayerOneBtn.slider.pause();\n\t\t\tsndPlayerOneBtn.slider.load();\n\t\t\tsndPlayerOneBtn.slider.oncanplaythrough = sndPlayerOneBtn.cbCanPlayThrough;\n\t\t}\n\t},\n\tcbCanPlayThrough() {\n\t\tsndPlayerOneBtn.duration = sndPlayerOneBtn.slider.duration;\n\t\tif (sndPlayerOneBtn.$pButton.html() === '<i class=\"icon pause\"></i>') {\n\t\t\tsndPlayerOneBtn.slider.play();\n\t\t}\n\t},\n\tcbOnSliderChange(newVal, meta) {\n\t\tif (meta.triggeredByUser && isFinite(sndPlayerOneBtn.slider.duration)) {\n\t\t\tsndPlayerOneBtn.slider.removeEventListener('timeupdate', sndPlayerOneBtn.cbTimeUpdate, false);\n\t\t\tsndPlayerOneBtn.slider.currentTime = (sndPlayerOneBtn.slider.duration * newVal) / 100;\n\t\t\tsndPlayerOneBtn.slider.addEventListener('timeupdate', sndPlayerOneBtn.cbTimeUpdate, false);\n\t\t}\n\t},\n\tcbTimeUpdate() {\n\t\tif (isFinite(sndPlayerOneBtn.slider.duration)) {\n\t\t\tconst percent = sndPlayerOneBtn.slider.currentTime / sndPlayerOneBtn.slider.duration;\n\t\t\tconst rangePosition = Math.round((percent) * 100);\n\t\t\tsndPlayerOneBtn.$slider.range('set value', rangePosition);\n\t\t\tif (sndPlayerOneBtn.slider.currentTime === sndPlayerOneBtn.duration) {\n\t\t\t\tsndPlayerOneBtn.$pButton.html('<i class=\"icon play\"></i>');\n\t\t\t}\n\t\t}\n\t},\n};\n$(document).ready(() => {\n\tsndPlayerOneBtn.initialize();\n});\n"],"file":"one-button-sound-player.js"}
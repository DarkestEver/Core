"use strict";

/*
 * Copyright (C) MIKO LLC - All Rights Reserved
 * Unauthorized copying of this file, via any medium is strictly prohibited
 * Proprietary and confidential
 * Written by Nikolay Beketov, 12 2019
 *
 */

/* global globalRootUrl,globalTranslate, Form, PbxApi */
var networks = {
  $getMyIpButton: $('#getmyip'),
  $formObj: $('#network-form'),
  vlansArray: {},
  validateRules: {
    gateway: {
      optional: true,
      rules: [{
        type: 'ipaddr',
        prompt: globalTranslate.nw_ValidateIppaddrNotRight
      }]
    },
    primarydns: {
      optional: true,
      rules: [{
        type: 'ipaddr',
        prompt: globalTranslate.nw_ValidateIppaddrNotRight
      }]
    },
    secondarydns: {
      optional: true,
      rules: [{
        type: 'ipaddr',
        prompt: globalTranslate.nw_ValidateIppaddrNotRight
      }]
    },
    extipaddr: {
      optional: true,
      rules: [{
        type: 'ipaddrWithPortOptional',
        prompt: globalTranslate.nw_ValidateExtIppaddrNotRight
      }, {
        type: 'extenalIpHost',
        prompt: globalTranslate.nw_ValidateExtIppaddrOrHostIsEmpty
      }]
    },
    exthostname: {
      depends: 'usenat',
      rules: [{
        type: 'extenalIpHost',
        prompt: globalTranslate.nw_ValidateExtIppaddrOrHostIsEmpty
      }]
    }
  },
  initialize: function () {
    function initialize() {
      networks.toggleDisabledFieldClass();
      $('#eth-interfaces-menu .item').tab();
      $('#usenat-checkbox').checkbox({
        onChange: function () {
          function onChange() {
            networks.toggleDisabledFieldClass();
          }

          return onChange;
        }()
      });
      $('.dropdown').dropdown();
      $('.dhcp-checkbox').checkbox({
        onChange: function () {
          function onChange() {
            networks.toggleDisabledFieldClass();
          }

          return onChange;
        }()
      });
      networks.$getMyIpButton.on('click', function (e) {
        e.preventDefault();
        networks.$getMyIpButton.addClass('loading disabled');
        PbxApi.GetExternalIp(networks.cbAfterGetExternalIp);
      }); // Удаление дополнительного сетевого интерфейса

      $('.delete-interface').api({
        url: "".concat(globalRootUrl, "network/delete/{value}"),
        method: 'POST',
        beforeSend: function () {
          function beforeSend(settings) {
            $(this).addClass('loading disabled');
            return settings;
          }

          return beforeSend;
        }(),
        onSuccess: function () {
          function onSuccess(response) {
            $(this).removeClass('loading disabled');
            $('.ui.message.ajax').remove();
            $.each(response.message, function (index, value) {
              networks.$formObj.after("<div class=\"ui ".concat(index, " message ajax\">").concat(value, "</div>"));
            });
            if (response.success) window.location.reload();
          }

          return onSuccess;
        }(),
        onFailure: function () {
          function onFailure(response) {
            $(this).removeClass('loading disabled');
            $('form').after(response);
          }

          return onFailure;
        }()
      }); // Очистка настроек дополнительного сетевого

      $('.delete-interface-new').on('click', function () {
        var initialValues = {
          interface_new: '',
          name_new: '',
          dhcp_new: 'on',
          ipaddr_new: '',
          subnet_new: '0'
        };
        networks.$formObj.form('set values', initialValues);
        $('#interface_new').dropdown('restore defaults');
        $('#dhcp-new-checkbox').checkbox('check');
        $('#eth-interfaces-menu .item').tab('change tab', $('#eth-interfaces-menu a.item').first().attr('data-tab'));
      });
      networks.initializeForm();
    }

    return initialize;
  }(),

  /**
   * Обработчик API функции по возврату структуры с IP адресом маршрутизатора
   */
  cbAfterGetExternalIp: function () {
    function cbAfterGetExternalIp(response) {
      if (response === false) {
        networks.$getMyIpButton.removeClass('loading disabled');
      } else {
        networks.$formObj.form('set value', 'extipaddr', response.ip);
        networks.$getMyIpButton.removeClass('loading disabled');
      }
    }

    return cbAfterGetExternalIp;
  }(),
  toggleDisabledFieldClass: function () {
    function toggleDisabledFieldClass() {
      $('#eth-interfaces-menu a').each(function (index, obj) {
        var eth = $(obj).attr('data-tab');

        if ($("#dhcp-".concat(eth, "-checkbox")).checkbox('is unchecked')) {
          $("#ip-address-group-".concat(eth)).removeClass('disabled');
          $("#not-dhcp-".concat(eth)).val('1');
        } else {
          $("#ip-address-group-".concat(eth)).addClass('disabled');
          $("#not-dhcp-".concat(eth)).val('');
        }

        networks.addNewFormRules(eth);
      });

      if ($('#usenat-checkbox').checkbox('is checked')) {
        $('.nated-settings-group').removeClass('disabled');
      } else {
        $('.nated-settings-group').addClass('disabled');
      }
    }

    return toggleDisabledFieldClass;
  }(),
  addNewFormRules: function () {
    function addNewFormRules(newRowId) {
      var nameClass = "name_".concat(newRowId);
      networks.validateRules[nameClass] = {
        identifier: nameClass,
        depends: "interface_".concat(newRowId),
        rules: [{
          type: 'empty',
          prompt: globalTranslate.nw_ValidateNameIsNotBeEmpty
        }]
      };
      var vlanClass = "vlanid_".concat(newRowId);
      networks.validateRules[vlanClass] = {
        depends: "interface_".concat(newRowId),
        identifier: vlanClass,
        rules: [{
          type: 'integer[0..4095]',
          prompt: globalTranslate.nw_ValidateVlanRange
        }, {
          type: "checkVlan[".concat(newRowId, "]"),
          prompt: globalTranslate.nw_ValidateVlanCross
        }]
      };
      var ipaddrClass = "ipaddr_".concat(newRowId);
      networks.validateRules[ipaddrClass] = {
        identifier: ipaddrClass,
        depends: "not-dhcp-".concat(newRowId),
        rules: [{
          type: 'empty',
          prompt: globalTranslate.nw_ValidateIppaddrIsEmpty
        }, {
          type: 'ipaddr',
          prompt: globalTranslate.nw_ValidateIppaddrNotRight
        }]
      };
      var dhcpClass = "dhcp_".concat(newRowId);
      networks.validateRules[dhcpClass] = {
        identifier: dhcpClass,
        depends: "interface_".concat(newRowId),
        rules: [{
          type: "dhcpOnVlanNetworks[".concat(newRowId, "]"),
          prompt: globalTranslate.nw_ValidateDHCPOnVlansDontSupport
        }]
      };
    }

    return addNewFormRules;
  }(),
  cbBeforeSendForm: function () {
    function cbBeforeSendForm(settings) {
      var result = settings;
      result.data = networks.$formObj.form('get values');
      return result;
    }

    return cbBeforeSendForm;
  }(),
  cbAfterSendForm: function () {
    function cbAfterSendForm() {}

    return cbAfterSendForm;
  }(),
  initializeForm: function () {
    function initializeForm() {
      Form.$formObj = networks.$formObj;
      Form.url = "".concat(globalRootUrl, "network/save");
      Form.validateRules = networks.validateRules;
      Form.cbBeforeSendForm = networks.cbBeforeSendForm;
      Form.cbAfterSendForm = networks.cbAfterSendForm;
      Form.initialize();
    }

    return initializeForm;
  }()
};

$.fn.form.settings.rules.ipaddr = function (value) {
  var result = true;
  var f = value.match(/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/);

  if (f == null) {
    result = false;
  } else {
    for (var i = 1; i < 5; i += 1) {
      var a = f[i];

      if (a > 255) {
        result = false;
      }
    }

    if (f[5] > 32) {
      result = false;
    }
  }

  return result;
};

$.fn.form.settings.rules.ipaddrWithPortOptional = function (value) {
  var result = true;
  var f = value.match(/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})(:[0-9]+)?$/);

  if (f == null) {
    result = false;
  } else {
    for (var i = 1; i < 5; i += 1) {
      var a = f[i];

      if (a > 255) {
        result = false;
      }
    }

    if (f[5] > 32) {
      result = false;
    }
  }

  return result;
};

$.fn.form.settings.rules.checkVlan = function (vlanValue, param) {
  var result = true;
  var vlansArray = {};
  var allValues = networks.$formObj.form('get values');

  if (allValues.interface_new !== undefined && allValues.interface_new > 0) {
    var newEthName = allValues["interface_".concat(allValues.interface_new)];
    vlansArray[newEthName] = [allValues.vlanid_new];

    if (allValues.vlanid_new === '') {
      result = false;
    }
  }

  $.each(allValues, function (index, value) {
    if (index === 'interface_new' || index === 'vlanid_new') return;

    if (index.indexOf('vlanid') >= 0) {
      var ethName = allValues["interface_".concat(index.split('_')[1])];

      if ($.inArray(value, vlansArray[ethName]) >= 0 && vlanValue === value && param === index.split('_')[1]) {
        result = false;
      } else {
        if (!(ethName in vlansArray)) {
          vlansArray[ethName] = [];
        }

        vlansArray[ethName].push(value);
      }
    }
  });
  return result;
};

$.fn.form.settings.rules.dhcpOnVlanNetworks = function (value, param) {
  var result = true;
  var vlanValue = networks.$formObj.form('get value', "vlanid_".concat(param));
  var dhcpValue = networks.$formObj.form('get value', "dhcp_".concat(param));

  if (vlanValue > 0 && dhcpValue === 'on') {
    result = false;
  }

  return result;
};

$.fn.form.settings.rules.extenalIpHost = function () {
  var allValues = networks.$formObj.form('get values');

  if (allValues.usenat === 'on') {
    if (allValues.exthostname === '' && allValues.extipaddr === '') {
      return false;
    }
  }

  return true;
};

$(document).ready(function () {
  networks.initialize();
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9OZXR3b3JrL25ldHdvcmstbW9kaWZ5LmpzIl0sIm5hbWVzIjpbIm5ldHdvcmtzIiwiJGdldE15SXBCdXR0b24iLCIkIiwiJGZvcm1PYmoiLCJ2bGFuc0FycmF5IiwidmFsaWRhdGVSdWxlcyIsImdhdGV3YXkiLCJvcHRpb25hbCIsInJ1bGVzIiwidHlwZSIsInByb21wdCIsImdsb2JhbFRyYW5zbGF0ZSIsIm53X1ZhbGlkYXRlSXBwYWRkck5vdFJpZ2h0IiwicHJpbWFyeWRucyIsInNlY29uZGFyeWRucyIsImV4dGlwYWRkciIsIm53X1ZhbGlkYXRlRXh0SXBwYWRkck5vdFJpZ2h0IiwibndfVmFsaWRhdGVFeHRJcHBhZGRyT3JIb3N0SXNFbXB0eSIsImV4dGhvc3RuYW1lIiwiZGVwZW5kcyIsImluaXRpYWxpemUiLCJ0b2dnbGVEaXNhYmxlZEZpZWxkQ2xhc3MiLCJ0YWIiLCJjaGVja2JveCIsIm9uQ2hhbmdlIiwiZHJvcGRvd24iLCJvbiIsImUiLCJwcmV2ZW50RGVmYXVsdCIsImFkZENsYXNzIiwiUGJ4QXBpIiwiR2V0RXh0ZXJuYWxJcCIsImNiQWZ0ZXJHZXRFeHRlcm5hbElwIiwiYXBpIiwidXJsIiwiZ2xvYmFsUm9vdFVybCIsIm1ldGhvZCIsImJlZm9yZVNlbmQiLCJzZXR0aW5ncyIsIm9uU3VjY2VzcyIsInJlc3BvbnNlIiwicmVtb3ZlQ2xhc3MiLCJyZW1vdmUiLCJlYWNoIiwibWVzc2FnZSIsImluZGV4IiwidmFsdWUiLCJhZnRlciIsInN1Y2Nlc3MiLCJ3aW5kb3ciLCJsb2NhdGlvbiIsInJlbG9hZCIsIm9uRmFpbHVyZSIsImluaXRpYWxWYWx1ZXMiLCJpbnRlcmZhY2VfbmV3IiwibmFtZV9uZXciLCJkaGNwX25ldyIsImlwYWRkcl9uZXciLCJzdWJuZXRfbmV3IiwiZm9ybSIsImZpcnN0IiwiYXR0ciIsImluaXRpYWxpemVGb3JtIiwiaXAiLCJvYmoiLCJldGgiLCJ2YWwiLCJhZGROZXdGb3JtUnVsZXMiLCJuZXdSb3dJZCIsIm5hbWVDbGFzcyIsImlkZW50aWZpZXIiLCJud19WYWxpZGF0ZU5hbWVJc05vdEJlRW1wdHkiLCJ2bGFuQ2xhc3MiLCJud19WYWxpZGF0ZVZsYW5SYW5nZSIsIm53X1ZhbGlkYXRlVmxhbkNyb3NzIiwiaXBhZGRyQ2xhc3MiLCJud19WYWxpZGF0ZUlwcGFkZHJJc0VtcHR5IiwiZGhjcENsYXNzIiwibndfVmFsaWRhdGVESENQT25WbGFuc0RvbnRTdXBwb3J0IiwiY2JCZWZvcmVTZW5kRm9ybSIsInJlc3VsdCIsImRhdGEiLCJjYkFmdGVyU2VuZEZvcm0iLCJGb3JtIiwiZm4iLCJpcGFkZHIiLCJmIiwibWF0Y2giLCJpIiwiYSIsImlwYWRkcldpdGhQb3J0T3B0aW9uYWwiLCJjaGVja1ZsYW4iLCJ2bGFuVmFsdWUiLCJwYXJhbSIsImFsbFZhbHVlcyIsInVuZGVmaW5lZCIsIm5ld0V0aE5hbWUiLCJ2bGFuaWRfbmV3IiwiaW5kZXhPZiIsImV0aE5hbWUiLCJzcGxpdCIsImluQXJyYXkiLCJwdXNoIiwiZGhjcE9uVmxhbk5ldHdvcmtzIiwiZGhjcFZhbHVlIiwiZXh0ZW5hbElwSG9zdCIsInVzZW5hdCIsImRvY3VtZW50IiwicmVhZHkiXSwibWFwcGluZ3MiOiI7O0FBQUE7Ozs7Ozs7O0FBUUE7QUFFQSxJQUFNQSxRQUFRLEdBQUc7QUFDaEJDLEVBQUFBLGNBQWMsRUFBRUMsQ0FBQyxDQUFDLFVBQUQsQ0FERDtBQUVoQkMsRUFBQUEsUUFBUSxFQUFFRCxDQUFDLENBQUMsZUFBRCxDQUZLO0FBR2hCRSxFQUFBQSxVQUFVLEVBQUUsRUFISTtBQUloQkMsRUFBQUEsYUFBYSxFQUFFO0FBQ2RDLElBQUFBLE9BQU8sRUFBRTtBQUNSQyxNQUFBQSxRQUFRLEVBQUUsSUFERjtBQUVSQyxNQUFBQSxLQUFLLEVBQUUsQ0FDTjtBQUNDQyxRQUFBQSxJQUFJLEVBQUUsUUFEUDtBQUVDQyxRQUFBQSxNQUFNLEVBQUVDLGVBQWUsQ0FBQ0M7QUFGekIsT0FETTtBQUZDLEtBREs7QUFVZEMsSUFBQUEsVUFBVSxFQUFF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LEVBQTVELEVBQWdFO0FBQy9ELGFBQU8sS0FBUDtBQUNBO0FBQ0Q7O0FBQ0QsU0FBTyxJQUFQO0FBQ0EsQ0FSRDs7QUFVQWIsQ0FBQyxDQUFDeUcsUUFBRCxDQUFELENBQVlDLEtBQVosQ0FBa0IsWUFBTTtBQUN2QjVHLEVBQUFBLFFBQVEsQ0FBQ29CLFVBQVQ7QUFDQSxDQUZEIiwic291cmNlc0NvbnRlbnQiOlsiLypcbiAqIENvcHlyaWdodCAoQykgTUlLTyBMTEMgLSBBbGwgUmlnaHRzIFJlc2VydmVkXG4gKiBVbmF1dGhvcml6ZWQgY29weWluZyBvZiB0aGlzIGZpbGUsIHZpYSBhbnkgbWVkaXVtIGlzIHN0cmljdGx5IHByb2hpYml0ZWRcbiAqIFByb3ByaWV0YXJ5IGFuZCBjb25maWRlbnRpYWxcbiAqIFdyaXR0ZW4gYnkgTmlrb2xheSBCZWtldG92LCAxMiAyMDE5XG4gKlxuICovXG5cbi8qIGdsb2JhbCBnbG9iYWxSb290VXJsLGdsb2JhbFRyYW5zbGF0ZSwgRm9ybSwgUGJ4QXBpICovXG5cbmNvbnN0IG5ldHdvcmtzID0ge1xuXHQkZ2V0TXlJcEJ1dHRvbjogJCgnI2dldG15aXAnKSxcblx0JGZvcm1PYmo6ICQoJyNuZXR3b3JrLWZvcm0nKSxcblx0dmxhbnNBcnJheToge30sXG5cdHZhbGlkYXRlUnVsZXM6IHtcblx0XHRnYXRld2F5OiB7XG5cdFx0XHRvcHRpb25hbDogdHJ1ZSxcblx0XHRcdHJ1bGVzOiBbXG5cdFx0XHRcdHtcblx0XHRcdFx0XHR0eXBlOiAnaXBhZGRyJyxcblx0XHRcdFx0XHRwcm9tcHQ6IGdsb2JhbFRyYW5zbGF0ZS5ud19WYWxpZGF0ZUlwcGFkZHJOb3RSaWdodCxcblx0XHRcdFx0fSxcblx0XHRcdF0sXG5cdFx0fSxcblx0XHRwcmltYXJ5ZG5zOiB7XG5cdFx0XHRvcHRpb25hbDogdHJ1ZSxcblx0XHRcdHJ1bGVzOiBbXG5cdFx0XHRcdHtcblx0XHRcdFx0XHR0eXBlOiAnaXBhZGRyJyxcblx0XHRcdFx0XHRwcm9tcHQ6IGdsb2JhbFRyYW5zbGF0ZS5ud19WYWxpZGF0ZUlwcGFkZHJOb3RSaWdodCxcblx0XHRcdFx0fSxcblx0XHRcdF0sXG5cdFx0fSxcblx0XHRzZWNvbmRhcnlkbnM6IHtcblx0XHRcdG9wdGlvbmFsOiB0cnVlLFxuXHRcdFx0cnVsZXM6IFtcblx0XHRcdFx0e1xuXHRcdFx0XHRcdHR5cGU6ICdpcGFkZHInLFxuXHRcdFx0XHRcdHByb21wdDogZ2xvYmFsVHJhbnNsYXRlLm53X1ZhbGlkYXRlSXBwYWRkck5vdFJpZ2h0LFxuXHRcdFx0XHR9LFxuXHRcdFx0XSxcblx0XHR9LFxuXHRcdGV4dGlwYWRkcjoge1xuXHRcdFx0b3B0aW9uYWw6IHRydWUsXG5cdFx0XHRydWxlczogW1xuXHRcdFx0XHR7XG5cdFx0XHRcdFx0dHlwZTogJ2lwYWRkcldpdGhQb3J0T3B0aW9uYWwnLFxuXHRcdFx0XHRcdHByb21wdDogZ2xvYmFsVHJhbnNsYXRlLm53X1ZhbGlkYXRlRXh0SXBwYWRkck5vdFJpZ2h0LFxuXHRcdFx0XHR9LFxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0dHlwZTogJ2V4dGVuYWxJcEhvc3QnLFxuXHRcdFx0XHRcdHByb21wdDogZ2xvYmFsVHJhbnNsYXRlLm53X1ZhbGlkYXRlRXh0SXBwYWRkck9ySG9zdElzRW1wdHksXG5cdFx0XHRcdH0sXG5cdFx0XHRdLFxuXHRcdH0sXG5cdFx0ZXh0aG9zdG5hbWU6IHtcblx0XHRcdGRlcGVuZHM6ICd1c2VuYXQnLFxuXHRcdFx0cnVsZXM6IFtcblx0XHRcdFx0e1xuXHRcdFx0XHRcdHR5cGU6ICdleHRlbmFsSXBIb3N0Jyxcblx0XHRcdFx0XHRwcm9tcHQ6IGdsb2JhbFRyYW5zbGF0ZS5ud19WYWxpZGF0ZUV4dElwcGFkZHJPckhvc3RJc0VtcHR5LFxuXHRcdFx0XHR9LFxuXHRcdFx0XSxcblx0XHR9LFxuXHR9LFxuXHRpbml0aWFsaXplKCkge1xuXHRcdG5ldHdvcmtzLnRvZ2dsZURpc2FibGVkRmllbGRDbGFzcygpO1xuXHRcdCQoJyNldGgtaW50ZXJmYWNlcy1tZW51IC5pdGVtJykudGFiKCk7XG5cblx0XHQkKCcjdXNlbmF0LWNoZWNrYm94JykuY2hlY2tib3goe1xuXHRcdFx0b25DaGFuZ2UoKSB7XG5cdFx0XHRcdG5ldHdvcmtzLnRvZ2dsZURpc2FibGVkRmllbGRDbGFzcygpO1xuXHRcdFx0fSxcblx0XHR9KTtcblx0XHQkKCcuZHJvcGRvd24nKVxuXHRcdFx0LmRyb3Bkb3duKCk7XG5cdFx0JCgnLmRoY3AtY2hlY2tib3gnKVxuXHRcdFx0LmNoZWNrYm94KHtcblx0XHRcdFx0b25DaGFuZ2UoKSB7XG5cdFx0XHRcdFx0bmV0d29ya3MudG9nZ2xlRGlzYWJsZWRGaWVsZENsYXNzKCk7XG5cdFx0XHRcdH0sXG5cdFx0XHR9KTtcblx0XHRuZXR3b3Jrcy4kZ2V0TXlJcEJ1dHRvbi5vbignY2xpY2snLCAoZSkgPT4ge1xuXHRcdFx0ZS5wcmV2ZW50RGVmYXVsdCgpO1xuXHRcdFx0bmV0d29ya3MuJGdldE15SXBCdXR0b24uYWRkQ2xhc3MoJ2xvYWRpbmcgZGlzYWJsZWQnKTtcblx0XHRcdFBieEFwaS5HZXRFeHRlcm5hbElwKG5ldHdvcmtzLmNiQWZ0ZXJHZXRFeHRlcm5hbElwKTtcblx0XHR9KTtcblxuXHRcdC8vINCj0LTQsNC70LXQvdC40LUg0LTQvtC/0L7Qu9C90LjRgtC10LvRjNC90L7Qs9C+INGB0LXRgtC10LLQvtCz0L4g0LjQvdGC0LXRgNGE0LXQudGB0LBcblx0XHQkKCcuZGVsZXRlLWludGVyZmFjZScpLmFwaSh7XG5cdFx0XHR1cmw6IGAke2dsb2JhbFJvb3RVcmx9bmV0d29yay9kZWxldGUve3ZhbHVlfWAsXG5cdFx0XHRtZXRob2Q6ICdQT1NUJyxcblx0XHRcdGJlZm9yZVNlbmQoc2V0dGluZ3MpIHtcblx0XHRcdFx0JCh0aGlzKS5hZGRDbGFzcygnbG9hZGluZyBkaXNhYmxlZCcpO1xuXHRcdFx0XHRyZXR1cm4gc2V0dGluZ3M7XG5cdFx0XHR9LFxuXG5cdFx0XHRvblN1Y2Nlc3MocmVzcG9uc2UpIHtcblx0XHRcdFx0JCh0aGlzKS5yZW1vdmVDbGFzcygnbG9hZGluZyBkaXNhYmxlZCcpO1xuXHRcdFx0XHQkKCcudWkubWVzc2FnZS5hamF4JykucmVtb3ZlKCk7XG5cdFx0XHRcdCQuZWFjaChyZXNwb25zZS5tZXNzYWdlLCAoaW5kZXgsIHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0bmV0d29ya3MuJGZvcm1PYmouYWZ0ZXIoYDxkaXYgY2xhc3M9XCJ1aSAke2luZGV4fSBtZXNzYWdlIGFqYXhcIj4ke3ZhbHVlfTwvZGl2PmApO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0aWYgKHJlc3BvbnNlLnN1Y2Nlc3MpIHdpbmRvdy5sb2NhdGlvbi5yZWxvYWQoKTtcblx0XHRcdH0sXG5cblx0XHRcdG9uRmFpbHVyZShyZXNwb25zZSkge1xuXHRcdFx0XHQkKHRoaXMpLnJlbW92ZUNsYXNzKCdsb2FkaW5nIGRpc2FibGVkJyk7XG5cdFx0XHRcdCQoJ2Zvcm0nKS5hZnRlcihyZXNwb25zZSk7XG5cdFx0XHR9LFxuXHRcdH0pO1xuXG5cdFx0Ly8g0J7Rh9C40YHRgtC60LAg0L3QsNGB0YLRgNC+0LXQuiDQtNC+0L/QvtC70L3QuNGC0LXQu9GM0L3QvtCz0L4g0YHQtdGC0LXQstC+0LPQvlxuXHRcdCQoJy5kZWxldGUtaW50ZXJmYWNlLW5ldycpLm9uKCdjbGljaycsICgpID0+IHtcblx0XHRcdGNvbnN0IGluaXRpYWxWYWx1ZXMgPSB7XG5cdFx0XHRcdGludGVyZmFjZV9uZXc6ICcnLFxuXHRcdFx0XHRuYW1lX25ldzogJycsXG5cdFx0XHRcdGRoY3BfbmV3OiAnb24nLFxuXHRcdFx0XHRpcGFkZHJfbmV3OiAnJyxcblx0XHRcdFx0c3VibmV0X25ldzogJzAnLFxuXHRcdFx0fTtcblx0XHRcdG5ldHdvcmtzLiRmb3JtT2JqLmZvcm0oJ3NldCB2YWx1ZXMnLCBpbml0aWFsVmFsdWVzKTtcblx0XHRcdCQoJyNpbnRlcmZhY2VfbmV3JykuZHJvcGRvd24oJ3Jlc3RvcmUgZGVmYXVsdHMnKTtcblx0XHRcdCQoJyNkaGNwLW5ldy1jaGVja2JveCcpLmNoZWNrYm94KCdjaGVjaycpO1xuXHRcdFx0JCgnI2V0aC1pbnRlcmZhY2VzLW1lbnUgLml0ZW0nKS50YWIoJ2NoYW5nZSB0YWInLCAkKCcjZXRoLWludGVyZmFjZXMtbWVudSBhLml0ZW0nKS5maXJzdCgpLmF0dHIoJ2RhdGEtdGFiJykpO1xuXHRcdH0pO1xuXG5cdFx0bmV0d29ya3MuaW5pdGlhbGl6ZUZvcm0oKTtcblx0fSxcblx0LyoqXG5cdCAqINCe0LHRgNCw0LHQvtGC0YfQuNC6IEFQSSDRhNGD0L3QutGG0LjQuCDQv9C+INCy0L7Qt9Cy0YDQsNGC0YMg0YHRgtGA0YPQutGC0YPRgNGLINGBIElQINCw0LTRgNC10YHQvtC8INC80LDRgNGI0YDRg9GC0LjQt9Cw0YLQvtGA0LBcblx0ICovXG5cdGNiQWZ0ZXJHZXRFeHRlcm5hbElwKHJlc3BvbnNlKSB7XG5cdFx0aWYgKHJlc3BvbnNlID09PSBmYWxzZSkge1xuXHRcdFx0bmV0d29ya3MuJGdldE15SXBCdXR0b24ucmVtb3ZlQ2xhc3MoJ2xvYWRpbmcgZGlzYWJsZWQnKTtcblx0XHR9IGVsc2Uge1xuXHRcdFx0bmV0d29ya3MuJGZvcm1PYmouZm9ybSgnc2V0IHZhbHVlJywgJ2V4dGlwYWRkcicsIHJlc3BvbnNlLmlwKTtcblx0XHRcdG5ldHdvcmtzLiRnZXRNeUlwQnV0dG9uLnJlbW92ZUNsYXNzKCdsb2FkaW5nIGRpc2FibGVkJyk7XG5cdFx0fVxuXHR9LFxuXHR0b2dnbGVEaXNhYmxlZEZpZWxkQ2xhc3MoKSB7XG5cdFx0JCgnI2V0aC1pbnRlcmZhY2VzLW1lbnUgYScpLmVhY2goKGluZGV4LCBvYmopID0+IHtcblx0XHRcdGNvbnN0IGV0aCA9ICQob2JqKS5hdHRyKCdkYXRhLXRhYicpO1xuXHRcdFx0aWYgKCQoYCNkaGNwLSR7ZXRofS1jaGVja2JveGApLmNoZWNrYm94KCdpcyB1bmNoZWNrZWQnKSkge1xuXHRcdFx0XHQkKGAjaXAtYWRkcmVzcy1ncm91cC0ke2V0aH1gKS5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTtcblx0XHRcdFx0JChgI25vdC1kaGNwLSR7ZXRofWApLnZhbCgnMScpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0JChgI2lwLWFkZHJlc3MtZ3JvdXAtJHtldGh9YCkuYWRkQ2xhc3MoJ2Rpc2FibGVkJyk7XG5cdFx0XHRcdCQoYCNub3QtZGhjcC0ke2V0aH1gKS52YWwoJycpO1xuXHRcdFx0fVxuXHRcdFx0bmV0d29ya3MuYWRkTmV3Rm9ybVJ1bGVzKGV0aCk7XG5cdFx0fSk7XG5cblx0XHRpZiAoJCgnI3VzZW5hdC1jaGVja2JveCcpLmNoZWNrYm94KCdpcyBjaGVja2VkJykpIHtcblx0XHRcdCQoJy5uYXRlZC1zZXR0aW5ncy1ncm91cCcpLnJlbW92ZUNsYXNzKCdkaXNhYmxlZCcpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHQkKCcubmF0ZWQtc2V0dGluZ3MtZ3JvdXAnKS5hZGRDbGFzcygnZGlzYWJsZWQnKTtcblx0XHR9XG5cdH0sXG5cdGFkZE5ld0Zvcm1SdWxlcyhuZXdSb3dJZCkge1xuXHRcdGNvbnN0IG5hbWVDbGFzcyA9IGBuYW1lXyR7bmV3Um93SWR9YDtcblx0XHRuZXR3b3Jrcy52YWxpZGF0ZVJ1bGVzW25hbWVDbGFzc10gPSB7XG5cdFx0XHRpZGVudGlmaWVyOiBuYW1lQ2xhc3MsXG5cdFx0XHRkZXBlbmRzOiBgaW50ZXJmYWNlXyR7bmV3Um93SWR9YCxcblx0XHRcdHJ1bGVzOiBbXG5cdFx0XHRcdHtcblx0XHRcdFx0XHR0eXBlOiAnZW1wdHknLFxuXHRcdFx0XHRcdHByb21wdDogZ2xvYmFsVHJhbnNsYXRlLm53X1ZhbGlkYXRlTmFtZUlzTm90QmVFbXB0eSxcblx0XHRcdFx0fSxcblx0XHRcdF0sXG5cblx0XHR9O1xuXG5cdFx0Y29uc3QgdmxhbkNsYXNzID0gYHZsYW5pZF8ke25ld1Jvd0lkfWA7XG5cdFx0bmV0d29ya3MudmFsaWRhdGVSdWxlc1t2bGFuQ2xhc3NdID0ge1xuXHRcdFx0ZGVwZW5kczogYGludGVyZmFjZV8ke25ld1Jvd0lkfWAsXG5cdFx0XHRpZGVudGlmaWVyOiB2bGFuQ2xhc3MsXG5cdFx0XHRydWxlczogW1xuXHRcdFx0XHR7XG5cdFx0XHRcdFx0dHlwZTogJ2ludGVnZXJbMC4uNDA5NV0nLFxuXHRcdFx0XHRcdHByb21wdDogZ2xvYmFsVHJhbnNsYXRlLm53X1ZhbGlkYXRlVmxhblJhbmdlLFxuXHRcdFx0XHR9LFxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0dHlwZTogYGNoZWNrVmxhblske25ld1Jvd0lkfV1gLFxuXHRcdFx0XHRcdHByb21wdDogZ2xvYmFsVHJhbnNsYXRlLm53X1ZhbGlkYXRlVmxhbkNyb3NzLFxuXHRcdFx0XHR9LFxuXHRcdFx0XSxcblxuXHRcdH07XG5cblx0XHRjb25zdCBpcGFkZHJDbGFzcyA9IGBpcGFkZHJfJHtuZXdSb3dJZH1gO1xuXHRcdG5ldHdvcmtzLnZhbGlkYXRlUnVsZXNbaXBhZGRyQ2xhc3NdID0ge1xuXHRcdFx0aWRlbnRpZmllcjogaXBhZGRyQ2xhc3MsXG5cdFx0XHRkZXBlbmRzOiBgbm90LWRoY3AtJHtuZXdSb3dJZH1gLFxuXHRcdFx0cnVsZXM6IFtcblx0XHRcdFx0e1xuXHRcdFx0XHRcdHR5cGU6ICdlbXB0eScsXG5cdFx0XHRcdFx0cHJvbXB0OiBnbG9iYWxUcmFuc2xhdGUubndfVmFsaWRhdGVJcHBhZGRySXNFbXB0eSxcblx0XHRcdFx0fSxcblx0XHRcdFx0e1xuXHRcdFx0XHRcdHR5cGU6ICdpcGFkZHInLFxuXHRcdFx0XHRcdHByb21wdDogZ2xvYmFsVHJhbnNsYXRlLm53X1ZhbGlkYXRlSXBwYWRkck5vdFJpZ2h0LFxuXHRcdFx0XHR9LFxuXHRcdFx0XSxcblx0XHR9O1xuXG5cdFx0Y29uc3QgZGhjcENsYXNzID0gYGRoY3BfJHtuZXdSb3dJZH1gO1xuXHRcdG5ldHdvcmtzLnZhbGlkYXRlUnVsZXNbZGhjcENsYXNzXSA9IHtcblx0XHRcdGlkZW50aWZpZXI6IGRoY3BDbGFzcyxcblx0XHRcdGRlcGVuZHM6IGBpbnRlcmZhY2VfJHtuZXdSb3dJZH1gLFxuXHRcdFx0cnVsZXM6IFtcblx0XHRcdFx0e1xuXHRcdFx0XHRcdHR5cGU6IGBkaGNwT25WbGFuTmV0d29ya3NbJHtuZXdSb3dJZH1dYCxcblx0XHRcdFx0XHRwcm9tcHQ6IGdsb2JhbFRyYW5zbGF0ZS5ud19WYWxpZGF0ZURIQ1BPblZsYW5zRG9udFN1cHBvcnQsXG5cdFx0XHRcdH0sXG5cdFx0XHRdLFxuXHRcdH07XG5cblx0fSxcblx0Y2JCZWZvcmVTZW5kRm9ybShzZXR0aW5ncykge1xuXHRcdGNvbnN0IHJlc3VsdCA9IHNldHRpbmdzO1xuXHRcdHJlc3VsdC5kYXRhID0gbmV0d29ya3MuJGZvcm1PYmouZm9ybSgnZ2V0IHZhbHVlcycpO1xuXHRcdHJldHVybiByZXN1bHQ7XG5cdH0sXG5cdGNiQWZ0ZXJTZW5kRm9ybSgpIHtcblxuXHR9LFxuXHRpbml0aWFsaXplRm9ybSgpIHtcblx0XHRGb3JtLiRmb3JtT2JqID0gbmV0d29ya3MuJGZvcm1PYmo7XG5cdFx0Rm9ybS51cmwgPSBgJHtnbG9iYWxSb290VXJsfW5ldHdvcmsvc2F2ZWA7XG5cdFx0Rm9ybS52YWxpZGF0ZVJ1bGVzID0gbmV0d29ya3MudmFsaWRhdGVSdWxlcztcblx0XHRGb3JtLmNiQmVmb3JlU2VuZEZvcm0gPSBuZXR3b3Jrcy5jYkJlZm9yZVNlbmRGb3JtO1xuXHRcdEZvcm0uY2JBZnRlclNlbmRGb3JtID0gbmV0d29ya3MuY2JBZnRlclNlbmRGb3JtO1xuXHRcdEZvcm0uaW5pdGlhbGl6ZSgpO1xuXHR9LFxufTtcblxuJC5mbi5mb3JtLnNldHRpbmdzLnJ1bGVzLmlwYWRkciA9ICh2YWx1ZSkgPT4ge1xuXHRsZXQgcmVzdWx0ID0gdHJ1ZTtcblx0Y29uc3QgZiA9IHZhbHVlLm1hdGNoKC9eKFxcZHsxLDN9KVxcLihcXGR7MSwzfSlcXC4oXFxkezEsM30pXFwuKFxcZHsxLDN9KSQvKTtcblx0aWYgKGYgPT0gbnVsbCkge1xuXHRcdHJlc3VsdCA9IGZhbHNlO1xuXHR9IGVsc2Uge1xuXHRcdGZvciAobGV0IGkgPSAxOyBpIDwgNTsgaSArPSAxKSB7XG5cdFx0XHRjb25zdCBhID0gZltpXTtcblx0XHRcdGlmIChhID4gMjU1KSB7XG5cdFx0XHRcdHJlc3VsdCA9IGZhbHNlO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRpZiAoZls1XSA+IDMyKSB7XG5cdFx0XHRyZXN1bHQgPSBmYWxzZTtcblx0XHR9XG5cdH1cblx0cmV0dXJuIHJlc3VsdDtcbn07XG5cbiQuZm4uZm9ybS5zZXR0aW5ncy5ydWxlcy5pcGFkZHJXaXRoUG9ydE9wdGlvbmFsID0gKHZhbHVlKSA9PiB7XG5cdGxldCByZXN1bHQgPSB0cnVlO1xuXHRjb25zdCBmID0gdmFsdWUubWF0Y2goL14oXFxkezEsM30pXFwuKFxcZHsxLDN9KVxcLihcXGR7MSwzfSlcXC4oXFxkezEsM30pKDpbMC05XSspPyQvKTtcblx0aWYgKGYgPT0gbnVsbCkge1xuXHRcdHJlc3VsdCA9IGZhbHNlO1xuXHR9IGVsc2Uge1xuXHRcdGZvciAobGV0IGkgPSAxOyBpIDwgNTsgaSArPSAxKSB7XG5cdFx0XHRjb25zdCBhID0gZltpXTtcblx0XHRcdGlmIChhID4gMjU1KSB7XG5cdFx0XHRcdHJlc3VsdCA9IGZhbHNlO1xuXHRcdFx0fVxuXHRcdH1cblx0XHRpZiAoZls1XSA+IDMyKSB7XG5cdFx0XHRyZXN1bHQgPSBmYWxzZTtcblx0XHR9XG5cdH1cblx0cmV0dXJuIHJlc3VsdDtcbn07XG5cbiQuZm4uZm9ybS5zZXR0aW5ncy5ydWxlcy5jaGVja1ZsYW4gPSAodmxhblZhbHVlLCBwYXJhbSkgPT4ge1xuXHRsZXQgcmVzdWx0ID0gdHJ1ZTtcblx0Y29uc3QgdmxhbnNBcnJheSA9IHt9O1xuXHRjb25zdCBhbGxWYWx1ZXMgPSBuZXR3b3Jrcy4kZm9ybU9iai5mb3JtKCdnZXQgdmFsdWVzJyk7XG5cdGlmIChhbGxWYWx1ZXMuaW50ZXJmYWNlX25ldyAhPT0gdW5kZWZpbmVkICYmIGFsbFZhbHVlcy5pbnRlcmZhY2VfbmV3ID4gMCkge1xuXHRcdGNvbnN0IG5ld0V0aE5hbWUgPSBhbGxWYWx1ZXNbYGludGVyZmFjZV8ke2FsbFZhbHVlcy5pbnRlcmZhY2VfbmV3fWBdO1xuXHRcdHZsYW5zQXJyYXlbbmV3RXRoTmFtZV0gPSBbYWxsVmFsdWVzLnZsYW5pZF9uZXddO1xuXHRcdGlmIChhbGxWYWx1ZXMudmxhbmlkX25ldyA9PT0gJycpIHtcblx0XHRcdHJlc3VsdCA9IGZhbHNlO1xuXHRcdH1cblx0fVxuXHQkLmVhY2goYWxsVmFsdWVzLCAoaW5kZXgsIHZhbHVlKSA9PiB7XG5cdFx0aWYgKGluZGV4ID09PSAnaW50ZXJmYWNlX25ldycgfHwgaW5kZXggPT09ICd2bGFuaWRfbmV3JykgcmV0dXJuO1xuXHRcdGlmIChpbmRleC5pbmRleE9mKCd2bGFuaWQnKSA+PSAwKSB7XG5cdFx0XHRjb25zdCBldGhOYW1lID0gYWxsVmFsdWVzW2BpbnRlcmZhY2VfJHtpbmRleC5zcGxpdCgnXycpWzFdfWBdO1xuXHRcdFx0aWYgKCQuaW5BcnJheSh2YWx1ZSwgdmxhbnNBcnJheVtldGhOYW1lXSkgPj0gMFxuXHRcdFx0XHQmJiB2bGFuVmFsdWUgPT09IHZhbHVlXG5cdFx0XHRcdCYmIHBhcmFtID09PSBpbmRleC5zcGxpdCgnXycpWzFdKSB7XG5cdFx0XHRcdHJlc3VsdCA9IGZhbHNlO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0aWYgKCEoZXRoTmFtZSBpbiB2bGFuc0FycmF5KSkge1xuXHRcdFx0XHRcdHZsYW5zQXJyYXlbZXRoTmFtZV0gPSBbXTtcblx0XHRcdFx0fVxuXHRcdFx0XHR2bGFuc0FycmF5W2V0aE5hbWVdLnB1c2godmFsdWUpO1xuXHRcdFx0fVxuXHRcdH1cblx0fSk7XG5cdHJldHVybiByZXN1bHQ7XG59O1xuXG4kLmZuLmZvcm0uc2V0dGluZ3MucnVsZXMuZGhjcE9uVmxhbk5ldHdvcmtzID0gKHZhbHVlLCBwYXJhbSkgPT4ge1xuXHRsZXQgcmVzdWx0ID0gdHJ1ZTtcblx0Y29uc3QgdmxhblZhbHVlID0gbmV0d29ya3MuJGZvcm1PYmouZm9ybSgnZ2V0IHZhbHVlJywgYHZsYW5pZF8ke3BhcmFtfWApO1xuXHRjb25zdCBkaGNwVmFsdWUgPSBuZXR3b3Jrcy4kZm9ybU9iai5mb3JtKCdnZXQgdmFsdWUnLCBgZGhjcF8ke3BhcmFtfWApO1xuXHRpZiAodmxhblZhbHVlID4gMCAmJiBkaGNwVmFsdWUgPT09ICdvbicpIHtcblx0XHRyZXN1bHQgPSBmYWxzZTtcblx0fVxuXHRyZXR1cm4gcmVzdWx0O1xufTtcblxuJC5mbi5mb3JtLnNldHRpbmdzLnJ1bGVzLmV4dGVuYWxJcEhvc3QgPSAoKSA9PiB7XG5cdGNvbnN0IGFsbFZhbHVlcyA9IG5ldHdvcmtzLiRmb3JtT2JqLmZvcm0oJ2dldCB2YWx1ZXMnKTtcblx0aWYgKGFsbFZhbHVlcy51c2VuYXQgPT09ICdvbicpIHtcblx0XHRpZiAoYWxsVmFsdWVzLmV4dGhvc3RuYW1lID09PSAnJyAmJiBhbGxWYWx1ZXMuZXh0aXBhZGRyID09PSAnJykge1xuXHRcdFx0cmV0dXJuIGZhbHNlO1xuXHRcdH1cblx0fVxuXHRyZXR1cm4gdHJ1ZTtcbn07XG5cbiQoZG9jdW1lbnQpLnJlYWR5KCgpID0+IHtcblx0bmV0d29ya3MuaW5pdGlhbGl6ZSgpO1xufSk7XG4iXX0=
{
  "version": 3,
  "sources": [
    "../../src/Fail2Ban/fail-to-ban-index.js"
  ],
  "names": [
    "fail2BanIndex",
    "$formObj",
    "$",
    "$bannedIpList",
    "$unbanButons",
    "$enableCheckBox",
    "validateRules",
    "maxretry",
    "identifier",
    "rules",
    "type",
    "prompt",
    "globalTranslate",
    "f2b_ValidateMaxRetryRange",
    "findtime",
    "f2b_ValidateFindTimeRange",
    "bantime",
    "f2b_ValidateBanTimeRange",
    "initialize",
    "PbxApi",
    "SystemGetBannedIp",
    "cbGetBannedIpList",
    "on",
    "e",
    "unbannedIp",
    "target",
    "attr",
    "data",
    "ip",
    "SystemUnBanIp",
    "cbAfterUnBanIp",
    "checkbox",
    "onChange",
    "changeFieldsLook",
    "initializeForm",
    "checked",
    "find",
    "each",
    "index",
    "obj",
    "removeClass",
    "addClass",
    "response",
    "htmlTable",
    "f2b_TableBannedHeader",
    "f2b_Reason",
    "f2b_IpAddres",
    "f2b_BanedTime",
    "sort",
    "a",
    "b",
    "keyA",
    "timeofban",
    "keyB",
    "key",
    "value",
    "blockDate",
    "Date",
    "reason",
    "jail",
    "toLocaleString",
    "f2b_Unban",
    "length",
    "f2b_TableBannedEmpty",
    "html",
    "cbBeforeSendForm",
    "settings",
    "result",
    "form",
    "cbAfterSendForm",
    "Form",
    "url",
    "globalRootUrl",
    "document",
    "ready"
  ],
  "mappings": "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",
  "sourcesContent": [
    "/*\n * Copyright (C) MIKO LLC - All Rights Reserved\n * Unauthorized copying of this file, via any medium is strictly prohibited\n * Proprietary and confidential\n * Written by Nikolay Beketov, 6 2018\n *\n */\n\n/* global globalTranslate, PbxApi, Form, globalRootUrl */\n\nconst fail2BanIndex = {\n\t$formObj: $('#fail2ban-settings-form'),\n\t$bannedIpList: $('#banned-ip-list'),\n\t$unbanButons: $('.unban-button'),\n\t$enableCheckBox: $('#fail2ban-switch'),\n\tvalidateRules: {\n\t\tmaxretry: {\n\t\t\tidentifier: 'maxretry',\n\t\t\trules: [\n\t\t\t\t{\n\t\t\t\t\ttype: 'integer[3..99]',\n\t\t\t\t\tprompt: globalTranslate.f2b_ValidateMaxRetryRange,\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t\tfindtime: {\n\t\t\tidentifier: 'findtime',\n\t\t\trules: [\n\t\t\t\t{\n\t\t\t\t\ttype: 'integer[300..86400]',\n\t\t\t\t\tprompt: globalTranslate.f2b_ValidateFindTimeRange,\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t\tbantime: {\n\t\t\tidentifier: 'bantime',\n\t\t\trules: [\n\t\t\t\t{\n\t\t\t\t\ttype: 'integer[300..86400]',\n\t\t\t\t\tprompt: globalTranslate.f2b_ValidateBanTimeRange,\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t},\n\n\tinitialize() {\n\t\tPbxApi.SystemGetBannedIp(fail2BanIndex.cbGetBannedIpList);\n\t\tfail2BanIndex.$bannedIpList.on('click', fail2BanIndex.$unbanButons, (e) => {\n\t\t\tconst unbannedIp = $(e.target).attr('data-value');\n\t\t\tconst data = {ip: unbannedIp};\n\t\t\tPbxApi.SystemUnBanIp(data, fail2BanIndex.cbAfterUnBanIp);\n\t\t});\n\n\t\tfail2BanIndex.$enableCheckBox.checkbox({\n\t\t\tonChange() {\n\t\t\t\tfail2BanIndex.changeFieldsLook();\n\t\t\t},\n\t\t});\n\t\tfail2BanIndex.changeFieldsLook();\n\t\tfail2BanIndex.initializeForm();\n\t},\n\tchangeFieldsLook() {\n\t\tconst checked = fail2BanIndex.$enableCheckBox.checkbox('is checked');\n\t\tfail2BanIndex.$formObj.find('.disability').each((index, obj) => {\n\t\t\tif (checked) {\n\t\t\t\t$(obj).removeClass('disabled');\n\t\t\t} else {\n\t\t\t\t$(obj).addClass('disabled');\n\t\t\t}\n\t\t});\n\t},\n\tcbGetBannedIpList(response) {\n\t\tlet htmlTable = `<h2 class=\"ui header\">${globalTranslate.f2b_TableBannedHeader}</h2>`;\n\t\thtmlTable += '<table class=\"ui very compact table\">';\n\t\thtmlTable += '<thead>';\n\t\thtmlTable += `<th>${globalTranslate.f2b_Reason}</th>`;\n\t\thtmlTable += `<th>${globalTranslate.f2b_IpAddres}</th>`;\n\t\thtmlTable += `<th>${globalTranslate.f2b_BanedTime}</th>`;\n\t\thtmlTable += '<th></th>';\n\t\thtmlTable += '</thead>';\n\t\thtmlTable += '<tbody>';\n\t\tresponse.sort((a, b) => {\n\t\t\tconst keyA = a.timeofban;\n\t\t\tconst keyB = b.timeofban;\n\t\t\t// Compare the 2 dates\n\t\t\tif (keyA < keyB) return 1;\n\t\t\tif (keyA > keyB) return -1;\n\t\t\treturn 0;\n\t\t});\n\t\t$.each(response, (key, value) => {\n\t\t\tconst blockDate = new Date(value.timeofban * 1000);\n\t\t\tlet reason = `f2b_Jail_${value.jail}`;\n\t\t\tif (reason in globalTranslate) {\n\t\t\t\treason = globalTranslate[reason];\n\t\t\t}\n\n\t\t\thtmlTable += '<tr>';\n\t\t\thtmlTable += `<td>${reason}</td>`;\n\t\t\thtmlTable += `<td>${value.ip}</td>`;\n\t\t\thtmlTable += `<td>${blockDate.toLocaleString()}</td>`;\n\t\t\thtmlTable += `<td class=\"right aligned collapsing\"><button class=\"ui icon basic mini button unban-button\" data-value=\"${value.ip}\"><i class=\"icon trash red\"></i>${globalTranslate.f2b_Unban}</button></td>`;\n\t\t\thtmlTable += '</tr>';\n\t\t});\n\t\tif (response.length === 0) {\n\t\t\thtmlTable += `<tr><td colspan=\"4\" class=\"center aligned\">${globalTranslate.f2b_TableBannedEmpty}</td></tr>`;\n\t\t}\n\t\thtmlTable += '<tbody>';\n\t\thtmlTable += '</table>';\n\t\tfail2BanIndex.$bannedIpList.html(htmlTable);\n\t},\n\tcbAfterUnBanIp() {\n\t\tPbxApi.SystemGetBannedIp(fail2BanIndex.cbGetBannedIpList);\n\t},\n\tcbBeforeSendForm(settings) {\n\t\tconst result = settings;\n\t\tresult.data = fail2BanIndex.$formObj.form('get values');\n\t\treturn result;\n\t},\n\tcbAfterSendForm() {\n\n\t},\n\tinitializeForm() {\n\t\tForm.$formObj = fail2BanIndex.$formObj;\n\t\tForm.url = `${globalRootUrl}fail2-ban/save`;\n\t\tForm.validateRules = fail2BanIndex.validateRules;\n\t\tForm.cbBeforeSendForm = fail2BanIndex.cbBeforeSendForm;\n\t\tForm.cbAfterSendForm = fail2BanIndex.cbAfterSendForm;\n\t\tForm.initialize();\n\t},\n};\n$(document).ready(() => {\n\tfail2BanIndex.initialize();\n});\n\n"
  ],
  "file": "fail-to-ban-index.js"
}
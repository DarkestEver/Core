{"version":3,"sources":["../../src/main/sentry-error-logger.js"],"names":["Sentry","onLoad","globalShowSentryReportDialog","sentryEventId","itIsKnownError","localStorage","getItem","globalTranslate","undefined","length","showReportDialog","eventId","title","sntry_Title","subtitle","sntry_Subtitle","subtitle2","sntry_Subtitle2","labelComments","sntry_LabelComments","labelClose","sntry_LabelClose","labelSubmit","sntry_LabelSubmit","errorGeneric","sntry_ErrorGeneric","errorFormEntry","sntry_ErrorFormEntry","successMessage","sntry_SuccessMessage","setItem","init","dsn","release","globalPBXVersion","beforeSend","event","hint","exception","event_id","configureScope","scope","setUser","id","globalPBXLicense","setTag","globalLastSentryEventId"],"mappings":";;AAAA;;;;;;;;AAOA;AAEAA,MAAM,CAACC,MAAP,CAAc,YAAM;AACnB,WAASC,4BAAT,CAAsCC,aAAtC,EAAqD;AAEpD,QAAMC,cAAc,GAAGC,YAAY,CAACC,OAAb,2BAAwCH,aAAxC,EAAvB;;AACA,QAAIC,cAAc,KAAK,IAAvB,EAA6B;AAC5B,UAAIG,eAAe,KAAKC,SAApB,IAAiCD,eAAe,CAACE,MAAhB,GAAyB,CAA9D,EAAiE;AAChET,QAAAA,MAAM,CAACU,gBAAP,CAAwB;AACvBC,UAAAA,OAAO,EAAER,aADc;AAEvBS,UAAAA,KAAK,EAAEL,eAAe,CAACM,WAFA;AAGvBC,UAAAA,QAAQ,EAAEP,eAAe,CAACQ,cAHH;AAIvBC,UAAAA,SAAS,EAAET,eAAe,CAACU,eAJJ;AAKvBC,UAAAA,aAAa,EAAEX,eAAe,CAACY,mBALR;AAMvBC,UAAAA,UAAU,EAAEb,eAAe,CAACc,gBANL;AAOvBC,UAAAA,WAAW,EAAEf,eAAe,CAACgB,iBAPN;AAQvBC,UAAAA,YAAY,EAAEjB,eAAe,CAACkB,kBARP;AASvBC,UAAAA,cAAc,EAAEnB,eAAe,CAACoB,oBATT;AAUvBC,UAAAA,cAAc,EAAErB,eAAe,CAACsB;AAVT,SAAxB;AAaA,OAdD,MAcO;AACN7B,QAAAA,MAAM,CAACU,gBAAP,CAAwB;AAAEC,UAAAA,OAAO,EAAER;AAAX,SAAxB;AACA;;AACDE,MAAAA,YAAY,CAACyB,OAAb,2BAAwC3B,aAAxC,GAAyD,uBAAzD;AACA;AACD;;AAEDH,EAAAA,MAAM,CAAC+B,IAAP,CAAY;AACXC,IAAAA,GAAG,EAAE,2DADM;AAEXC,IAAAA,OAAO,oBAAaC,gBAAb,CAFI;AAGXC,IAAAA,UAHW;AAAA,0BAGAC,KAHA,EAGOC,IAHP,EAGa;AACvB;AACA,YAAID,KAAK,CAACE,SAAV,EAAqB;AACpBpC,UAAAA,4BAA4B,CAACkC,KAAK,CAACG,QAAP,CAA5B;AACA;;AACD,eAAOH,KAAP;AACA;;AATU;AAAA;AAAA,GAAZ;AAYApC,EAAAA,MAAM,CAACwC,cAAP,CAAsB,UAACC,KAAD,EAAW;AAChCA,IAAAA,KAAK,CAACC,OAAN,CAAc;AAAEC,MAAAA,EAAE,EAAEC;AAAN,KAAd;AACAH,IAAAA,KAAK,CAACI,MAAN,CAAa,SAAb,EAAwB,eAAxB;AACA,GAHD;;AAKA,MAAIC,uBAAJ,EAA6B;AAC5B5C,IAAAA,4BAA4B,CAAC4C,uBAAD,CAA5B;AACA;AACD,CA9CD","sourcesContent":["/*\n * Copyright (C) MIKO LLC - All Rights Reserved\n * Unauthorized copying of this file, via any medium is strictly prohibited\n * Proprietary and confidential\n * Written by Nikolay Beketov, 5 2019\n *\n */\n/* global Sentry, globalPBXVersion, globalPBXLicense, globalLastSentryEventId, globalTranslate */\n\nSentry.onLoad(() => {\n\tfunction globalShowSentryReportDialog(sentryEventId) {\n\n\t\tconst itIsKnownError = localStorage.getItem(`sentry_lastError${sentryEventId}`);\n\t\tif (itIsKnownError === null) {\n\t\t\tif (globalTranslate !== undefined && globalTranslate.length > 0) {\n\t\t\t\tSentry.showReportDialog({\n\t\t\t\t\teventId: sentryEventId,\n\t\t\t\t\ttitle: globalTranslate.sntry_Title,\n\t\t\t\t\tsubtitle: globalTranslate.sntry_Subtitle,\n\t\t\t\t\tsubtitle2: globalTranslate.sntry_Subtitle2,\n\t\t\t\t\tlabelComments: globalTranslate.sntry_LabelComments,\n\t\t\t\t\tlabelClose: globalTranslate.sntry_LabelClose,\n\t\t\t\t\tlabelSubmit: globalTranslate.sntry_LabelSubmit,\n\t\t\t\t\terrorGeneric: globalTranslate.sntry_ErrorGeneric,\n\t\t\t\t\terrorFormEntry: globalTranslate.sntry_ErrorFormEntry,\n\t\t\t\t\tsuccessMessage: globalTranslate.sntry_SuccessMessage,\n\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tSentry.showReportDialog({ eventId: sentryEventId });\n\t\t\t}\n\t\t\tlocalStorage.setItem(`sentry_lastError${sentryEventId}`, 'theFormHasAlreadySent');\n\t\t}\n\t}\n\n\tSentry.init({\n\t\tdsn: 'https://a8d729459beb446eb3cbb9df997dcc7b@centry.miko.ru/1',\n\t\trelease: `mikopbx@${globalPBXVersion}`,\n\t\tbeforeSend(event, hint) {\n\t\t\t// Check if it is an exception, and if so, show the report dialog\n\t\t\tif (event.exception) {\n\t\t\t\tglobalShowSentryReportDialog(event.event_id);\n\t\t\t}\n\t\t\treturn event;\n\t\t},\n\t});\n\n\tSentry.configureScope((scope) => {\n\t\tscope.setUser({ id: globalPBXLicense });\n\t\tscope.setTag('library', 'web-interface');\n\t});\n\n\tif (globalLastSentryEventId) {\n\t\tglobalShowSentryReportDialog(globalLastSentryEventId);\n\t}\n});\n"],"file":"sentry-error-logger.js"}
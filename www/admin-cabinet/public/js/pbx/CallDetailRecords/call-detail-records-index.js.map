{"version":3,"sources":["../../src/CallDetailRecords/call-detail-records-index.js"],"names":["CDRPlayer","id","html5Audio","document","getElementById","$row","$","$pButton","find","$dButton","$slider","$spanDuration","removeEventListener","cbOnMetadataLoaded","cbTimeUpdate","unbind","on","e","preventDefault","play","window","location","target","attr","addEventListener","cbOnSrcMediaError","range","min","max","start","onChange","cbOnSliderChange","spanDuration","isFinite","duration","closest","date","Date","setSeconds","currentTime","toISOString","substr","text","newVal","meta","triggeredByUser","percent","rangePosition","Math","round","removeClass","addClass","paused","pause","callDetailRecords","$cdrTable","$globalSearch","$dateRangeSelector","dataTable","players","initialize","initializeDateRangeSelector","keyCode","val","length","applyFilter","search","serverSide","processing","ajax","url","globalRootUrl","type","paging","scrollY","height","offset","top","sDom","deferRender","pageLength","createdRow","row","data","DT_RowClass","eq","html","drawCallback","Extensions","UpdatePhonesRepresent","language","SemanticLocalization","dataTableLocalisation","ordering","DataTable","tr","child","isShown","hide","showRecords","show","each","index","playerRow","htmlPlayer","forEach","record","i","recordingfile","undefined","recordFileName","src_num","dst_num","replace","options","ranges","globalTranslate","сal_Today","moment","сal_Yesterday","subtract","сal_LastWeek","сal_Last30Days","сal_ThisMonth","startOf","endOf","сal_LastMonth","alwaysShowCalendars","autoUpdateInput","linkedCalendars","maxDate","locale","format","separator","applyLabel","сal_ApplyBtn","cancelLabel","сal_CancelBtn","fromLabel","сal_from","toLabel","сal_to","customRangeLabel","сal_CustomPeriod","daysOfWeek","calendarText","days","monthNames","months","firstDay","startDate","endDate","daterangepicker","cbDateRangeSelectorOnSelect","end","label","draw","ready"],"mappings":"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","sourcesContent":["/*\n * Copyright (C) MIKO LLC - All Rights Reserved\n * Unauthorized copying of this file, via any medium is strictly prohibited\n * Proprietary and confidential\n * Written by Nikolay Beketov, 7 2018\n *\n */\n\n/* global globalRootUrl, SemanticLocalization, Extensions, moment, globalTranslate */\n/**\n * Класс динамически создаваемых проигрываетелй для CDR\n *\n */\nclass CDRPlayer {\n\tconstructor(id) {\n\t\tthis.id = id;\n\t\tthis.html5Audio = document.getElementById(`audio-player-${id}`);\n\t\tconst $row = $(`#${id}`);\n\t\tthis.$pButton = $row.find('i.play'); // play button\n\t\tthis.$dButton = $row.find('i.download'); // download button\n\t\tthis.$slider = $row.find('div.cdr-player');\n\t\tthis.$spanDuration = $row.find('span.cdr-duration');\n\t\tthis.html5Audio.removeEventListener('timeupdate', this.cbOnMetadataLoaded, false);\n\t\tthis.html5Audio.removeEventListener('loadedmetadata', this.cbTimeUpdate, false);\n\t\tthis.$pButton.unbind();\n\t\tthis.$dButton.unbind();\n\n\n\t\t// play button event listenter\n\t\tthis.$pButton.on('click', (e) => {\n\t\t\te.preventDefault();\n\t\t\tthis.play();\n\t\t});\n\n\t\t// download button event listenter\n\t\tthis.$dButton.on('click', (e) => {\n\t\t\te.preventDefault();\n\t\t\twindow.location = $(e.target).attr('data-value');\n\t\t});\n\n\t\tthis.html5Audio.addEventListener('loadedmetadata', this.cbOnMetadataLoaded, false);\n\n\t\t// timeupdate event listener\n\t\tthis.html5Audio.addEventListener('timeupdate', this.cbTimeUpdate, false);\n\n\t\t// no src handler\n\t\tthis.html5Audio.addEventListener('error', this.cbOnSrcMediaError, false);\n\n\t\tthis.$slider.range({\n\t\t\tmin: 0,\n\t\t\tmax: 100,\n\t\t\tstart: 0,\n\t\t\tonChange: this.cbOnSliderChange,\n\t\t\thtml5Audio: this.html5Audio,\n\t\t\tcbTimeUpdate: this.cbTimeUpdate,\n\t\t\tspanDuration: this.$spanDuration,\n\t\t});\n\t}\n\n\t/**\n\t * Обработчик подгрузки метаданных\n\t */\n\tcbOnMetadataLoaded() {\n\t\tif (isFinite(this.duration)) {\n\t\t\tconst $row = $(this).closest('tr');\n\t\t\tconst date = new Date(null);\n\t\t\tdate.setSeconds(this.currentTime); // specify value for SECONDS here\n\t\t\tconst currentTime = date.toISOString().substr(14, 5);\n\t\t\tdate.setSeconds(this.duration); // specify value for SECONDS here\n\t\t\tconst duration = date.toISOString().substr(14, 5);\n\t\t\t$row.find('span.cdr-duration').text(`${currentTime}/${duration}`);\n\t\t}\n\t}\n\n\t/**\n\t * Колбек на сдвиг слайдера проигрывателя\n\t * @param newVal\n\t * @param meta\n\t */\n\tcbOnSliderChange(newVal, meta) {\n\t\tif (meta.triggeredByUser && isFinite(this.html5Audio.duration)) {\n\t\t\tthis.html5Audio.removeEventListener('timeupdate', this.cbTimeUpdate, false);\n\t\t\tthis.html5Audio.currentTime = (this.html5Audio.duration * newVal) / 100;\n\t\t\tthis.html5Audio.addEventListener('timeupdate', this.cbTimeUpdate, false);\n\t\t}\n\t\tif (isFinite(this.html5Audio.duration)) {\n\t\t\tconst date = new Date(null);\n\t\t\tdate.setSeconds(this.html5Audio.currentTime); // specify value for SECONDS here\n\t\t\tconst currentTime = date.toISOString().substr(14, 5);\n\t\t\tdate.setSeconds(this.html5Audio.duration); // specify value for SECONDS here\n\t\t\tconst duration = date.toISOString().substr(14, 5);\n\t\t\tthis.spanDuration.text(`${currentTime}/${duration}`);\n\t\t}\n\t}\n\n\t/**\n\t * Колбек на изменение позиции проигрываемого файла из HTML5 аудиотега\n\t */\n\tcbTimeUpdate() {\n\t\tif (isFinite(this.duration)) {\n\t\t\tconst percent = this.currentTime / this.duration;\n\t\t\tconst rangePosition = Math.min(Math.round((percent) * 100), 100);\n\t\t\tconst $row = $(this).closest('tr');\n\t\t\t$row.find('div.cdr-player').range('set value', rangePosition);\n\t\t\tif (this.currentTime === this.duration) {\n\t\t\t\t$row.find('i.pause').removeClass('pause').addClass('play');\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Запуск и остановка воспроизведения аудио файла\n\t * по клику на иконку Play\n\t */\n\tplay() {\n\t\t// start music\n\t\tif (this.html5Audio.paused) {\n\t\t\tthis.html5Audio.play();\n\t\t\t// remove play, add pause\n\t\t\tthis.$pButton.removeClass('play').addClass('pause');\n\t\t} else { // pause music\n\t\t\tthis.html5Audio.pause();\n\t\t\t// remove pause, add play\n\t\t\tthis.$pButton.removeClass('pause').addClass('play');\n\t\t}\n\t}\n\n\t/**\n\t * Обработка ошибки полученя звукового файла\n\t */\n\tcbOnSrcMediaError() {\n\t\t$(this).closest('tr').addClass('disabled');\n\t}\n}\n\n/**\n * Класс страницы с CDR\n */\nconst callDetailRecords = {\n\t$cdrTable: $('#cdr-table'),\n\t$globalSearch: $('#globalsearch'),\n\t$dateRangeSelector: $('#date-range-selector'),\n\tdataTable: {},\n\tplayers: [],\n\tinitialize() {\n\t\tcallDetailRecords.initializeDateRangeSelector();\n\n\t\tcallDetailRecords.$globalSearch.on('keyup', (e) => {\n\t\t\tif (e.keyCode === 13\n\t\t\t\t|| e.keyCode === 8\n\t\t\t\t|| callDetailRecords.$globalSearch.val().length === 0) {\n\t\t\t\tconst text = `${callDetailRecords.$dateRangeSelector.val()} ${callDetailRecords.$globalSearch.val()}`;\n\t\t\t\tcallDetailRecords.applyFilter(text);\n\t\t\t}\n\t\t});\n\n\t\tcallDetailRecords.$cdrTable.dataTable({\n\t\t\tsearch: {\n\t\t\t\tsearch: `${callDetailRecords.$dateRangeSelector.val()} ${callDetailRecords.$globalSearch.val()}`,\n\t\t\t},\n\t\t\tserverSide: true,\n\t\t\tprocessing: true,\n\t\t\tajax: {\n\t\t\t\turl: `${globalRootUrl}call-detail-records/getNewRecords`,\n\t\t\t\ttype: 'POST',\n\t\t\t},\n\t\t\tpaging: true,\n\t\t\tscrollY: $(window).height() - callDetailRecords.$cdrTable.offset().top - 420,\n\t\t\t// stateSave: true,\n\t\t\tsDom: 'rtip',\n\t\t\tdeferRender: true,\n\t\t\tpageLength: 17,\n\t\t\t// scrollCollapse: true,\n\t\t\t// scroller: true,\n\t\t\t/**\n\t\t\t * Конструктор строки CDR\n\t\t\t * @param row\n\t\t\t * @param data\n\t\t\t */\n\t\t\tcreatedRow(row, data) {\n\t\t\t\tif (data.DT_RowClass === 'detailed') {\n\t\t\t\t\t$('td', row).eq(0).html('<i class=\"icon caret down\"></i>');\n\t\t\t\t} else {\n\t\t\t\t\t$('td', row).eq(0).html('');\n\t\t\t\t}\n\n\t\t\t\t$('td', row).eq(1).html(data[0]);\n\t\t\t\t$('td', row).eq(2)\n\t\t\t\t\t.html(data[1])\n\t\t\t\t\t.addClass('need-update');\n\t\t\t\t$('td', row).eq(3)\n\t\t\t\t\t.html(data[2])\n\t\t\t\t\t.addClass('need-update');\n\t\t\t\t$('td', row).eq(4).html(data[3]);\n\t\t\t},\n\t\t\t/**\n\t\t\t * Draw event - fired once the table has completed a draw.\n\t\t\t */\n\t\t\tdrawCallback() {\n\t\t\t\tExtensions.UpdatePhonesRepresent('need-update');\n\t\t\t},\n\t\t\tlanguage: SemanticLocalization.dataTableLocalisation,\n\t\t\tordering: false,\n\t\t});\n\t\tcallDetailRecords.dataTable = callDetailRecords.$cdrTable.DataTable();\n\n\t\tcallDetailRecords.dataTable.on('draw', () => {\n\t\t\tcallDetailRecords.$globalSearch.closest('div').removeClass('loading');\n\t\t});\n\n\n\t\t// Add event listener for opening and closing details\n\t\tcallDetailRecords.$cdrTable.on('click', 'tr.detailed', (e) => {\n\t\t\tconst tr = $(e.target).closest('tr');\n\t\t\tconst row = callDetailRecords.dataTable.row(tr);\n\n\t\t\tif (row.child.isShown()) {\n\t\t\t\t// This row is already open - close it\n\t\t\t\trow.child.hide();\n\t\t\t\ttr.removeClass('shown');\n\t\t\t} else {\n\t\t\t\t// Open this row\n\n\t\t\t\trow.child(callDetailRecords.showRecords(row.data())).show();\n\n\t\t\t\ttr.addClass('shown');\n\t\t\t\trow.child().find('.detail-record-row').each((index, playerRow) => {\n\t\t\t\t\tconst id = $(playerRow).attr('id');\n\t\t\t\t\treturn new CDRPlayer(id);\n\t\t\t\t});\n\t\t\t\tExtensions.UpdatePhonesRepresent('need-update');\n\t\t\t}\n\t\t});\n\t},\n\t/**\n\t * Отрисовывает набор с записями разговоров при клике на строку\n\t */\n\tshowRecords(data) {\n\t\tlet htmlPlayer = '<table class=\"ui very basic table cdr-player\"><tbody>';\n\t\tdata[4].forEach((record, i) => {\n\t\t\tif (i > 0) {\n\t\t\t\thtmlPlayer += '<td><tr></tr></td>';\n\t\t\t\thtmlPlayer += '<td><tr></tr></td>';\n\t\t\t}\n\t\t\tif (record.recordingfile === undefined\n\t\t\t\t|| record.recordingfile === null\n\t\t\t\t|| record.recordingfile.length === 0) {\n\t\t\t\tconst recordFileName = `Call_record_between_${record.src_num}_and_${record.dst_num}_from_${data[0]}`;\n\t\t\t\trecordFileName.replace(/[^\\w\\s!?]/g, '');\n\n\t\t\t\thtmlPlayer += `\n\n<tr class=\"detail-record-row disabled\" id=\"${record.id}\">\n   \t<td class=\"one wide\"></td>\n   \t<td class=\"one wide right aligned\">\n   \t\t<i class=\"ui icon play\"></i>\n\t   \t<audio preload=\"metadata\" id=\"audio-player-${record.id}\" src=\"\"></audio>\n\t</td>\n    <td class=\"five wide\">\n    \t<div class=\"ui range cdr-player\" data-value=\"${record.id}\"></div>\n    </td>\n    <td class=\"one wide\"><span class=\"cdr-duration\"></span></td>\n    <td class=\"one wide\">\n    \t<i class=\"ui icon download\" data-value=\"\"></i>\n    </td>\n    <td class=\"right aligned\"><span class=\"need-update\">${record.src_num}</span></td>\n    <td class=\"one wide center aligned\"><i class=\"icon exchange\"></i></td>\n   \t<td class=\"left aligned\"><span class=\"need-update\">${record.dst_num}</span></td>\n</tr>`;\n\t\t\t} else {\n\t\t\t\tconst recordFileName = `Call_record_between_${record.src_num}_and_${record.dst_num}_from_${data[0]}`;\n\t\t\t\trecordFileName.replace(/[^\\w\\s!?]/g, '');\n\n\t\t\t\thtmlPlayer += `\n\n<tr class=\"detail-record-row\" id=\"${record.id}\">\n   \t<td class=\"one wide\"></td>\n   \t<td class=\"one wide right aligned\">\n   \t\t<i class=\"ui icon play\"></i>\n\t   \t<audio preload=\"metadata\" id=\"audio-player-${record.id}\" src=\"/pbxcore/api/cdr/playback?view=${record.recordingfile}\"></audio>\n\t</td>\n    <td class=\"five wide\">\n    \t<div class=\"ui range cdr-player\" data-value=\"${record.id}\"></div>\n    </td>\n    <td class=\"one wide\"><span class=\"cdr-duration\"></span></td>\n    <td class=\"one wide\">\n    \t<i class=\"ui icon download\" data-value=\"/pbxcore/api/cdr/playback?view=${record.recordingfile}&download=1&filename=${recordFileName}.mp3\"></i>\n    </td>\n    <td class=\"right aligned\"><span class=\"need-update\">${record.src_num}</span></td>\n    <td class=\"one wide center aligned\"><i class=\"icon exchange\"></i></td>\n   \t<td class=\"left aligned\"><span class=\"need-update\">${record.dst_num}</span></td>\n</tr>`;\n\t\t\t}\n\t\t});\n\t\thtmlPlayer += '</tbody></table>';\n\t\treturn htmlPlayer;\n\t},\n\t/**\n\t *\n\t */\n\tinitializeDateRangeSelector() {\n\t\tconst options = {};\n\n\t\toptions.ranges = {\n\t\t\t[globalTranslate.сal_Today]: [moment(), moment()],\n\t\t\t[globalTranslate.сal_Yesterday]: [moment().subtract(1, 'days'), moment().subtract(1, 'days')],\n\t\t\t[globalTranslate.сal_LastWeek]: [moment().subtract(6, 'days'), moment()],\n\t\t\t[globalTranslate.сal_Last30Days]: [moment().subtract(29, 'days'), moment()],\n\t\t\t[globalTranslate.сal_ThisMonth]: [moment().startOf('month'), moment().endOf('month')],\n\t\t\t[globalTranslate.сal_LastMonth]: [moment().subtract(1, 'month').startOf('month'), moment().subtract(1, 'month').endOf('month')],\n\t\t};\n\t\toptions.alwaysShowCalendars = true;\n\t\toptions.autoUpdateInput = true;\n\t\toptions.linkedCalendars = true;\n\t\toptions.maxDate = moment();\n\t\toptions.locale = {\n\t\t\tformat: 'DD/MM/YYYY',\n\t\t\tseparator: ' - ',\n\t\t\tapplyLabel: globalTranslate.сal_ApplyBtn,\n\t\t\tcancelLabel: globalTranslate.сal_CancelBtn,\n\t\t\tfromLabel: globalTranslate.сal_from,\n\t\t\ttoLabel: globalTranslate.сal_to,\n\t\t\tcustomRangeLabel: globalTranslate.сal_CustomPeriod,\n\t\t\tdaysOfWeek: SemanticLocalization.calendarText.days,\n\t\t\tmonthNames: SemanticLocalization.calendarText.months,\n\t\t\tfirstDay: 1,\n\t\t};\n\t\toptions.startDate = moment();\n\t\toptions.endDate = moment();\n\t\tcallDetailRecords.$dateRangeSelector.daterangepicker(\n\t\t\toptions,\n\t\t\tcallDetailRecords.cbDateRangeSelectorOnSelect,\n\t\t);\n\t},\n\t/**\n\t * Обработчик выбора периода\n\t * @param start\n\t * @param end\n\t * @param label\n\t */\n\tcbDateRangeSelectorOnSelect(start, end, label) {\n\t\tconst text = `${start.format('DD/MM/YYYY')} ${end.format('DD/MM/YYYY')} ${callDetailRecords.$globalSearch.val()}`;\n\t\tcallDetailRecords.applyFilter(text);\n\t},\n\t/**\n\t *\n\t */\n\tapplyFilter(text) {\n\t\tcallDetailRecords.dataTable.search(text).draw();\n\t\tcallDetailRecords.$globalSearch.closest('div').addClass('loading');\n\t},\n};\n$(document).ready(() => {\n\tcallDetailRecords.initialize();\n});\n"],"file":"call-detail-records-index.js"}
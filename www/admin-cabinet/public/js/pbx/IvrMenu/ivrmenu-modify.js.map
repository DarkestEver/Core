{"version":3,"sources":["../../src/IvrMenu/ivrmenu-modify.js"],"names":["$","fn","form","settings","rules","existRule","hasClass","ivrMenu","$formObj","$number","$dirrtyField","$errorMessages","$rowTemplate","defaultExtension","actionsRowsCount","validateRules","name","identifier","type","prompt","globalTranslate","iv_ValidateNameIsEmpty","extension","iv_ValidateExtensionIsEmpty","iv_ValidateExtensionIsDouble","timeout_extension","iv_ValidateTimeoutExtensionIsEmpty","audio_message_id","iv_ValidateAudioFileIsEmpty","timeout","iv_ValidateTimeoutOutOfRange","number_of_repeat","iv_ValidateRepeatNumberOutOfRange","initialize","dropdown","on","newNumber","Extensions","checkAvailability","defaultNumber","el","addNewActionRow","rebuildActionExtensionsDropdown","val","Math","random","trigger","preventDefault","initializeForm","buildIvrMenuActions","objActions","JSON","parse","ivrActions","forEach","element","length","addNewFormRules","newRowId","$digitsClass","iv_ValidateDigitsIsNotCorrect","$extensionClass","iv_ValidateExtensionIsNotCorrect","paramObj","param","id","extensionRepresent","digits","undefined","$actionTemplate","clone","removeClass","attr","find","html","ex_SelectNumber","append","getDropdownSettingsWithoutEmpty","cbOnExtensionSelect","fixBugDropdownIcon","e","remove","cbBeforeSendForm","result","data","arrActions","each","index","obj","rowId","push","iv_ValidateNoIVRExtensions","addClass","actions","stringify","cbAfterSendForm","Form","url","globalRootUrl","checkDoublesDigits","value","count","document","ready"],"mappings":"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","sourcesContent":["/*\n * Copyright (C) MIKO LLC - All Rights Reserved\n * Unauthorized copying of this file, via any medium is strictly prohibited\n * Proprietary and confidential\n * Written by Nikolay Beketov, 5 2018\n *\n */\n\n/* global globalRootUrl, ivrActions, globalTranslate, Form, Extensions */\n\n$.fn.form.settings.rules.existRule = () => $('#extension-error').hasClass('hidden');\n\nconst ivrMenu = {\n\t$formObj: $('#ivr-menu-form'),\n\t$number: $('#extension'),\n\t$dirrtyField: $('#dirrty'),\n\t$errorMessages: $('#form-error-messages'),\n\t$rowTemplate: $('#row-template'),\n\tdefaultExtension: '',\n\tactionsRowsCount: 0,\n\tvalidateRules: {\n\t\tname: {\n\t\t\tidentifier: 'name',\n\t\t\trules: [\n\t\t\t\t{\n\t\t\t\t\ttype: 'empty',\n\t\t\t\t\tprompt: globalTranslate.iv_ValidateNameIsEmpty,\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t\textension: {\n\t\t\tidentifier: 'extension',\n\t\t\trules: [\n\t\t\t\t{\n\t\t\t\t\ttype: 'empty',\n\t\t\t\t\tprompt: globalTranslate.iv_ValidateExtensionIsEmpty,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttype: 'existRule',\n\t\t\t\t\tprompt: globalTranslate.iv_ValidateExtensionIsDouble,\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t\ttimeout_extension: {\n\t\t\tidentifier: 'timeout_extension',\n\t\t\trules: [\n\t\t\t\t{\n\t\t\t\t\ttype: 'empty',\n\t\t\t\t\tprompt: globalTranslate.iv_ValidateTimeoutExtensionIsEmpty,\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t\taudio_message_id: {\n\t\t\tidentifier: 'audio_message_id',\n\t\t\trules: [\n\t\t\t\t{\n\t\t\t\t\ttype: 'empty',\n\t\t\t\t\tprompt: globalTranslate.iv_ValidateAudioFileIsEmpty,\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t\ttimeout: {\n\t\t\tidentifier: 'timeout',\n\t\t\trules: [\n\t\t\t\t{\n\t\t\t\t\ttype: 'integer[0..99]',\n\t\t\t\t\tprompt: globalTranslate.iv_ValidateTimeoutOutOfRange,\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t\tnumber_of_repeat: {\n\t\t\tidentifier: 'number_of_repeat',\n\t\t\trules: [\n\t\t\t\t{\n\t\t\t\t\ttype: 'integer[0..99]',\n\t\t\t\t\tprompt: globalTranslate.iv_ValidateRepeatNumberOutOfRange,\n\t\t\t\t},\n\t\t\t],\n\t\t},\n\t},\n\n\tinitialize() {\n\t\t$('.ui.dropdown').dropdown();\n\n\t\t// Динамическая прововерка свободен ли выбранный номер\n\t\tivrMenu.$number.on('change', () => {\n\t\t\tconst newNumber = ivrMenu.$formObj.form('get value', 'extension');\n\t\t\tExtensions.checkAvailability(ivrMenu.defaultNumber, newNumber);\n\t\t});\n\n\t\t$('#add-new-ivr-action').on('click', (el) => {\n\t\t\tivrMenu.addNewActionRow();\n\t\t\tivrMenu.rebuildActionExtensionsDropdown();\n\t\t\tivrMenu.$dirrtyField.val(Math.random());\n\t\t\tivrMenu.$dirrtyField.trigger('change');\n\t\t\tel.preventDefault();\n\t\t});\n\t\tivrMenu.initializeForm();\n\n\t\tivrMenu.buildIvrMenuActions();\n\n\t\tivrMenu.defaultExtension = ivrMenu.$formObj.form('get value', 'extension');\n\t},\n\tbuildIvrMenuActions() {\n\t\tconst objActions = JSON.parse(ivrActions);\n\t\tobjActions.forEach((element) => {\n\t\t\tivrMenu.addNewActionRow(element);\n\t\t});\n\t\tif (objActions.length === 0) ivrMenu.addNewActionRow();\n\n\t\tivrMenu.rebuildActionExtensionsDropdown();\n\t},\n\taddNewFormRules(newRowId) {\n\t\tconst $digitsClass = `digits-${newRowId}`;\n\t\tivrMenu.validateRules[$digitsClass] = {\n\t\t\tidentifier: $digitsClass,\n\t\t\trules: [\n\t\t\t\t{\n\t\t\t\t\ttype: 'regExp[/^[0-9]{1,7}$/]',\n\t\t\t\t\tprompt: globalTranslate.iv_ValidateDigitsIsNotCorrect,\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\ttype: 'checkDoublesDigits',\n\t\t\t\t\tprompt: globalTranslate.iv_ValidateDigitsIsNotCorrect,\n\t\t\t\t},\n\t\t\t],\n\n\t\t};\n\t\tconst $extensionClass = `extension-${newRowId}`;\n\t\tivrMenu.validateRules[$extensionClass] = {\n\t\t\tidentifier: $extensionClass,\n\t\t\trules: [\n\t\t\t\t{\n\t\t\t\t\ttype: 'empty',\n\t\t\t\t\tprompt: globalTranslate.iv_ValidateExtensionIsNotCorrect,\n\t\t\t\t},\n\t\t\t],\n\n\t\t};\n\t},\n\taddNewActionRow(paramObj) {\n\t\tlet param = {\n\t\t\tid: '',\n\t\t\textension: '',\n\t\t\textensionRepresent: '',\n\t\t\tdigits: '',\n\t\t};\n\t\tif (paramObj !== undefined) {\n\t\t\tparam = paramObj;\n\t\t}\n\t\tivrMenu.actionsRowsCount += 1;\n\t\tconst $actionTemplate = ivrMenu.$rowTemplate.clone();\n\t\t$actionTemplate\n\t\t\t.removeClass('hidden')\n\t\t\t.attr('id', `row-${ivrMenu.actionsRowsCount}`)\n\t\t\t.attr('data-value', ivrMenu.actionsRowsCount)\n\t\t\t.attr('style', '');\n\n\t\t$actionTemplate.find('input[name=\"digits-id\"]')\n\t\t\t.attr('id', `digits-${ivrMenu.actionsRowsCount}`)\n\t\t\t.attr('name', `digits-${ivrMenu.actionsRowsCount}`)\n\t\t\t.attr('value', param.digits);\n\n\t\t$actionTemplate.find('input[name=\"extension-id\"]')\n\t\t\t.attr('id', `extension-${ivrMenu.actionsRowsCount}`)\n\t\t\t.attr('name', `extension-${ivrMenu.actionsRowsCount}`)\n\t\t\t.attr('value', param.extension);\n\t\t$actionTemplate.find('div.delete-action-row')\n\t\t\t.attr('data-value', ivrMenu.actionsRowsCount);\n\n\t\tif (param.extensionRepresent.length > 0) {\n\t\t\t$actionTemplate.find('div.default.text').removeClass('default').html(param.extensionRepresent);\n\t\t} else {\n\t\t\t$actionTemplate.find('div.default.text').html(globalTranslate.ex_SelectNumber);\n\t\t}\n\n\t\t$('#actions-place').append($actionTemplate);\n\t\tivrMenu.addNewFormRules(ivrMenu.actionsRowsCount);\n\t},\n\trebuildActionExtensionsDropdown() {\n\t\t$('.forwarding-select').dropdown(Extensions.getDropdownSettingsWithoutEmpty(ivrMenu.cbOnExtensionSelect));\n\t\tExtensions.fixBugDropdownIcon();\n\t\t$('.delete-action-row').on('click', function (e) {\n\t\t\te.preventDefault();\n\t\t\tconst id = $(this).attr('data-value');\n\t\t\tdelete ivrMenu.validateRules[`digits-${id}`];\n\t\t\tdelete ivrMenu.validateRules[`extension-${id}`];\n\t\t\t$(`#row-${id}`).remove();\n\t\t\tivrMenu.$dirrtyField.val(Math.random());\n\t\t\tivrMenu.$dirrtyField.trigger('change');\n\t\t});\n\t},\n\tcbBeforeSendForm(settings) {\n\t\tlet result = settings;\n\n\t\tresult.data = ivrMenu.$formObj.form('get values');\n\t\tconst arrActions = [];\n\n\t\t$('.action-row').each((index, obj) => {\n\t\t\tconst rowId = $(obj).attr('data-value');\n\t\t\tif (rowId > 0) {\n\t\t\t\tarrActions.push({\n\t\t\t\t\tdigits: ivrMenu.$formObj.form('get value', `digits-${rowId}`),\n\t\t\t\t\textension: ivrMenu.$formObj.form('get value', `extension-${rowId}`),\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\tif (arrActions.length === 0) {\n\t\t\tresult = false;\n\t\t\tivrMenu.$errorMessages.html(globalTranslate.iv_ValidateNoIVRExtensions);\n\t\t\tivrMenu.$formObj.addClass('error');\n\t\t} else {\n\t\t\tresult.data.actions = JSON.stringify(arrActions);\n\t\t}\n\t\treturn result;\n\t},\n\t/**\n\t * Срабатывает при выборе номера из выпадающего списка\n\t */\n\tcbOnExtensionSelect() {\n\t\tivrMenu.$dirrtyField.val(Math.random());\n\t\tivrMenu.$dirrtyField.trigger('change');\n\t},\n\tcbAfterSendForm() {\n\n\t},\n\tinitializeForm() {\n\t\tForm.$formObj = ivrMenu.$formObj;\n\t\tForm.url = `${globalRootUrl}ivr-menu/save`;\n\t\tForm.validateRules = ivrMenu.validateRules;\n\t\tForm.cbBeforeSendForm = ivrMenu.cbBeforeSendForm;\n\t\tForm.cbAfterSendForm = ivrMenu.cbAfterSendForm;\n\t\tForm.initialize();\n\t},\n};\n\n$.fn.form.settings.rules.checkDoublesDigits = (value) => {\n\tlet count = 0;\n\t$(\"input[id^='digits']\").each((index, obj) => {\n\t\tif (ivrMenu.$formObj.form('get value', `${obj.id}`) === value) count += 1;\n\t});\n\n\treturn (count === 1);\n};\n\n$(document).ready(() => {\n\tivrMenu.initialize();\n});\n\n"],"file":"ivrmenu-modify.js"}
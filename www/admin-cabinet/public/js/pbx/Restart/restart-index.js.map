{"version":3,"sources":["../../src/Restart/restart-index.js"],"names":["restart","initialize","$","on","e","target","closest","addClass","PbxApi","SystemReboot","SystemShutDown","currentCallsWorker","timeOut","timeOutHandle","$currentCallsInfo","restartWorker","window","clearTimeout","timeoutHandle","worker","GetCurrentCalls","cbGetCurrentCalls","setTimeout","response","empty","respObject","resultUl","globalTranslate","rs_CurrentCalls","rs_DateCall","rs_Src","rs_Dst","each","index","value","start","src_num","dst_num","html","Extensions","UpdatePhonesRepresent","document","ready"],"mappings":"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","sourcesContent":["/*\n * Copyright (C) MIKO LLC - All Rights Reserved\n * Unauthorized copying of this file, via any medium is strictly prohibited\n * Proprietary and confidential\n * Written by Nikolay Beketov, 6 2018\n *\n */\n\n/* global globalTranslate, PbxApi, Extensions */\n\nconst restart = {\n\tinitialize() {\n\t\t$('#restart-button').on('click', (e) => {\n\t\t\t$(e.target).closest('button').addClass('loading');\n\t\t\tPbxApi.SystemReboot();\n\t\t});\n\t\t$('#shutdown-button').on('click', (e) => {\n\t\t\t$(e.target).closest('button').addClass('loading');\n\t\t\tPbxApi.SystemShutDown();\n\t\t});\n\t},\n};\n\nconst currentCallsWorker = {\n\ttimeOut: 3000,\n\ttimeOutHandle: '',\n\t$currentCallsInfo: $('#current-calls-info'),\n\tinitialize() {\n\t\tcurrentCallsWorker.restartWorker();\n\t},\n\trestartWorker() {\n\t\twindow.clearTimeout(currentCallsWorker.timeoutHandle);\n\t\tcurrentCallsWorker.worker();\n\t},\n\tworker() {\n\t\tPbxApi.GetCurrentCalls(currentCallsWorker.cbGetCurrentCalls);\n\t\tcurrentCallsWorker.timeoutHandle\n\t\t\t= window.setTimeout(currentCallsWorker.worker, currentCallsWorker.timeOut);\n\t},\n\tcbGetCurrentCalls(response) {\n\t\tcurrentCallsWorker.$currentCallsInfo.empty();\n\t\tif (response === false || typeof response !== 'object') return;\n\t\tconst respObject = response;\n\t\tlet resultUl = `<h2 class=\"ui header\">${globalTranslate.rs_CurrentCalls}</h2>`;\n\t\tresultUl += '<table class=\"ui very compact table\">';\n\t\tresultUl += '<thead>';\n\t\tresultUl += `<th></th><th>${globalTranslate.rs_DateCall}</th><th>${globalTranslate.rs_Src}</th><th>${globalTranslate.rs_Dst}</th>`;\n\t\tresultUl += '</thead>';\n\t\tresultUl += '<tbody>';\n\t\t$.each(respObject, (index, value) => {\n\t\t\tresultUl += '<tr>';\n\t\t\tresultUl += '<td><i class=\"spinner loading icon\"></i></td>';\n\t\t\tresultUl += `<td>${value.start}</td>`;\n\t\t\tresultUl += `<td class=\"need-update\">${value.src_num}</td>`;\n\t\t\tresultUl += `<td class=\"need-update\">${value.dst_num}</td>`;\n\t\t\tresultUl += '</tr>';\n\t\t});\n\t\tresultUl += '</tbody></table>';\n\t\tcurrentCallsWorker.$currentCallsInfo.html(resultUl);\n\t\tExtensions.UpdatePhonesRepresent('need-update');\n\t},\n};\n\n\n$(document).ready(() => {\n\trestart.initialize();\n\tcurrentCallsWorker.initialize();\n});\n\n"],"file":"restart-index.js"}
{"version":3,"sources":["../../src/PbxExtensionModules/pbx-extension-module-status.js"],"names":["pbxExtesionStatus","$toggle","$","$ajaxMessagesDiv","initialize","checkbox","onChecked","uniqid","closest","attr","addClass","find","text","globalTranslate","ext_ModuleStatusChanging","enableModule","PbxApi","SystemReloadModule","onUnchecked","disableModule","cbAfterEnable","remove","api","url","globalRootUrl","on","urlData","onSuccess","response","success","ext_ModuleDisabledStatusEnabled","ext_ModuleDisabledStatusDisabled","previousMessage","each","message","index","value","after","removeClass","cbAfterDisable","document","ready"],"mappings":"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","sourcesContent":["/*\n * Copyright (C) MIKO LLC - All Rights Reserved\n * Unauthorized copying of this file, via any medium is strictly prohibited\n * Proprietary and confidential\n * Written by Nikolay Beketov, 10 2018\n *\n */\n\n/* global globalRootUrl, PbxApi, globalTranslate */\n\nconst pbxExtesionStatus = {\n\t$toggle: $('#module-status-toggle'),\n\t$ajaxMessagesDiv: $('#ajax-messages'),\n\tinitialize() {\n\t\tpbxExtesionStatus.$toggle\n\t\t\t.checkbox({\n\t\t\t\tonChecked() {\n\t\t\t\t\tconst uniqid = $(this).closest('.ui.toggle.checkbox').attr('data-value');\n\t\t\t\t\tpbxExtesionStatus.$toggle.addClass('disabled');\n\t\t\t\t\tpbxExtesionStatus.$toggle.find('label').text(globalTranslate.ext_ModuleStatusChanging);\n\t\t\t\t\tpbxExtesionStatus.enableModule(uniqid, PbxApi.SystemReloadModule);\n\t\t\t\t},\n\t\t\t\tonUnchecked() {\n\t\t\t\t\tconst uniqid = $(this).closest('.ui.toggle.checkbox').attr('data-value');\n\t\t\t\t\tpbxExtesionStatus.$toggle.find('label').text(globalTranslate.ext_ModuleStatusChanging);\n\t\t\t\t\tpbxExtesionStatus.$toggle.addClass('disabled');\n\t\t\t\t\tpbxExtesionStatus.disableModule(uniqid, PbxApi.SystemReloadModule);\n\t\t\t\t},\n\t\t\t});\n\t},\n\t/**\n\t * Включить модуль, с проверкой ссылочной целостности\n\t * @param params - параметры запроса.\n\t * @param cbAfterEnable - колбек функция\n\t */\n\tenableModule(uniqid, cbAfterEnable) {\n\t\t$('.ui.message.ajax').remove();\n\t\t$.api({\n\t\t\turl: `${globalRootUrl}pbx-extension-modules/enable/{uniqid}`,\n\t\t\ton: 'now',\n\t\t\turlData: {\n\t\t\t\tuniqid,\n\t\t\t},\n\t\t\tonSuccess(response) {\n\t\t\t\tif (response.success) {\n\t\t\t\t\tpbxExtesionStatus.$toggle.checkbox('set checked');\n\t\t\t\t\tcbAfterEnable(uniqid);\n\t\t\t\t\tpbxExtesionStatus.$toggle.find('label').text(globalTranslate.ext_ModuleDisabledStatusEnabled);\n\t\t\t\t} else {\n\t\t\t\t\tpbxExtesionStatus.$toggle.checkbox('set unchecked');\n\t\t\t\t\tpbxExtesionStatus.$toggle.find('label').text(globalTranslate.ext_ModuleDisabledStatusDisabled);\n\t\t\t\t\tlet previousMessage = '';\n\t\t\t\t\t$.each(response.message, (index, value) => {\n\t\t\t\t\t\tif (previousMessage !== value) {\n\t\t\t\t\t\t\tpbxExtesionStatus.$ajaxMessagesDiv\n\t\t\t\t\t\t\t\t.after(`<div class=\"ui ${index} message ajax\">${value}</div>`);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tpreviousMessage = value;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tpbxExtesionStatus.$toggle.removeClass('disabled');\n\t\t\t},\n\n\t\t});\n\t},\n\t/**\n\t * Выключить модуль, с проверкой ссылочной целостности\n\t * @param uniqid - ID модуля\n\t * @param cbAfterDisable - колбек функция\n\t */\n\tdisableModule(uniqid, cbAfterDisable) {\n\t\t$('.ui.message.ajax').remove();\n\t\t$.api({\n\t\t\turl: `${globalRootUrl}pbx-extension-modules/disable/{uniqid}`,\n\t\t\ton: 'now',\n\t\t\turlData: {\n\t\t\t\tuniqid,\n\t\t\t},\n\t\t\tonSuccess(response) {\n\t\t\t\tif (response.success) {\n\t\t\t\t\tpbxExtesionStatus.$toggle.checkbox('set unchecked');\n\t\t\t\t\tcbAfterDisable(uniqid);\n\t\t\t\t\tpbxExtesionStatus.$toggle.find('label').text(globalTranslate.ext_ModuleDisabledStatusDisabled);\n\t\t\t\t} else {\n\t\t\t\t\tpbxExtesionStatus.$toggle.checkbox('set checked');\n\t\t\t\t\tpbxExtesionStatus.$toggle.find('label').text(globalTranslate.ext_ModuleDisabledStatusEnabled);\n\t\t\t\t\tlet previousMessage = '';\n\t\t\t\t\t$.each(response.message, (index, value) => {\n\t\t\t\t\t\tif (previousMessage !== value) {\n\t\t\t\t\t\t\tpbxExtesionStatus.$ajaxMessagesDiv\n\t\t\t\t\t\t\t\t.after(`<div class=\"ui ${index} message ajax\">${value}</div>`);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tpreviousMessage = value;\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tpbxExtesionStatus.$toggle.removeClass('disabled');\n\t\t\t},\n\n\t\t});\n\t},\n};\n\n$(document).ready(() => {\n\tpbxExtesionStatus.initialize();\n});\n"],"file":"pbx-extension-module-status.js"}
{"version":3,"sources":["../../src/PbxExtensionModules/pbx-extension-module-status.js"],"names":["pbxExtesionStatus","$toggle","$","initialize","checkbox","onChecked","uniqid","closest","attr","addClass","find","text","globalTranslate","ext_ModuleStatusChanging","enableModule","PbxApi","SystemReloadModule","onUnchecked","disableModule","cbAfterEnable","api","url","globalRootUrl","on","urlData","onSuccess","response","success","ext_ModuleDisabledStatusEnabled","event","document","createEvent","initEvent","window","dispatchEvent","ext_ModuleDisabledStatusDisabled","UserMessage","showMultiString","message","removeClass","cbAfterDisable","ready"],"mappings":";;AAAA;;;;;;;;AAQA;AAEA,IAAMA,iBAAiB,GAAG;AACzBC,EAAAA,OAAO,EAAEC,CAAC,CAAC,uBAAD,CADe;AAEzBC,EAAAA,UAFyB;AAAA,0BAEZ;AACZH,MAAAA,iBAAiB,CAACC,OAAlB,CACEG,QADF,CACW;AACTC,QAAAA,SADS;AAAA,+BACG;AACX,gBAAMC,MAAM,GAAGJ,CAAC,CAAC,IAAD,CAAD,CAAQK,OAAR,CAAgB,qBAAhB,EAAuCC,IAAvC,CAA4C,YAA5C,CAAf;AACAR,YAAAA,iBAAiB,CAACC,OAAlB,CAA0BQ,QAA1B,CAAmC,UAAnC;AACAT,YAAAA,iBAAiB,CAACC,OAAlB,CAA0BS,IAA1B,CAA+B,OAA/B,EAAwCC,IAAxC,CAA6CC,eAAe,CAACC,wBAA7D;AACAb,YAAAA,iBAAiB,CAACc,YAAlB,CAA+BR,MAA/B,EAAuCS,MAAM,CAACC,kBAA9C;AACA;;AANQ;AAAA;AAOTC,QAAAA,WAPS;AAAA,iCAOK;AACb,gBAAMX,MAAM,GAAGJ,CAAC,CAAC,IAAD,CAAD,CAAQK,OAAR,CAAgB,qBAAhB,EAAuCC,IAAvC,CAA4C,YAA5C,CAAf;AACAR,YAAAA,iBAAiB,CAACC,OAAlB,CAA0BS,IAA1B,CAA+B,OAA/B,EAAwCC,IAAxC,CAA6CC,eAAe,CAACC,wBAA7D;AACAb,YAAAA,iBAAiB,CAACC,OAAlB,CAA0BQ,QAA1B,CAAmC,UAAnC;AACAT,YAAAA,iBAAiB,CAACkB,aAAlB,CAAgCZ,MAAhC,EAAwCS,MAAM,CAACC,kBAA/C;AACA;;AAZQ;AAAA;AAAA,OADX;AAeA;;AAlBwB;AAAA;;AAmBzB;;;;;AAKAF,EAAAA,YAxByB;AAAA,0BAwBZR,MAxBY,EAwBJa,aAxBI,EAwBW;AACnCjB,MAAAA,CAAC,CAACkB,GAAF,CAAM;AACLC,QAAAA,GAAG,YAAKC,aAAL,0CADE;AAELC,QAAAA,EAAE,EAAE,KAFC;AAGLC,QAAAA,OAAO,EAAE;AACRlB,UAAAA,MAAM,EAANA;AADQ,SAHJ;AAMLmB,QAAAA,SANK;AAAA,6BAMKC,QANL,EAMe;AACnB,gBAAIA,QAAQ,CAACC,OAAb,EAAsB;AACrB3B,cAAAA,iBAAiB,CAACC,OAAlB,CAA0BG,QAA1B,CAAmC,aAAnC;AACAe,cAAAA,aAAa,CAACb,MAAD,CAAb;AACAN,cAAAA,iBAAiB,CAACC,OAAlB,CAA0BS,IAA1B,CAA+B,OAA/B,EAAwCC,IAAxC,CAA6CC,eAAe,CAACgB,+BAA7D;AACA,kBAAMC,KAAK,GAAGC,QAAQ,CAACC,WAAT,CAAqB,OAArB,CAAd;AACAF,cAAAA,KAAK,CAACG,SAAN,CAAgB,qBAAhB,EAAuC,KAAvC,EAA8C,IAA9C;AACAC,cAAAA,MAAM,CAACC,aAAP,CAAqBL,KAArB;AACA,aAPD,MAOO;AACN7B,cAAAA,iBAAiB,CAACC,OAAlB,CAA0BG,QAA1B,CAAmC,eAAnC;AACAJ,cAAAA,iBAAiB,CAACC,OAAlB,CAA0BS,IAA1B,CAA+B,OAA/B,EAAwCC,IAAxC,CAA6CC,eAAe,CAACuB,gCAA7D;AACAC,cAAAA,WAAW,CAACC,eAAZ,CAA4BX,QAAQ,CAACY,OAArC;AACA;;AACDtC,YAAAA,iBAAiB,CAACC,OAAlB,CAA0BsC,WAA1B,CAAsC,UAAtC;AACA;;AApBI;AAAA;AAAA,OAAN;AAuBA;;AAhDwB;AAAA;;AAiDzB;;;;;AAKArB,EAAAA,aAtDyB;AAAA,2BAsDXZ,MAtDW,EAsDHkC,cAtDG,EAsDa;AACrCtC,MAAAA,CAAC,CAACkB,GAAF,CAAM;AACLC,QAAAA,GAAG,YAAKC,aAAL,2CADE;AAELC,QAAAA,EAAE,EAAE,KAFC;AAGLC,QAAAA,OAAO,EAAE;AACRlB,UAAAA,MAAM,EAANA;AADQ,SAHJ;AAMLmB,QAAAA,SANK;AAAA,6BAMKC,QANL,EAMe;AACnB,gBAAIA,QAAQ,CAACC,OAAb,EAAsB;AACrB3B,cAAAA,iBAAiB,CAACC,OAAlB,CAA0BG,QAA1B,CAAmC,eAAnC;AACAoC,cAAAA,cAAc,CAAClC,MAAD,CAAd;AACAN,cAAAA,iBAAiB,CAACC,OAAlB,CAA0BS,IAA1B,CAA+B,OAA/B,EAAwCC,IAAxC,CAA6CC,eAAe,CAACuB,gCAA7D;AACA,kBAAMN,KAAK,GAAGC,QAAQ,CAACC,WAAT,CAAqB,OAArB,CAAd;AACAF,cAAAA,KAAK,CAACG,SAAN,CAAgB,qBAAhB,EAAuC,KAAvC,EAA8C,IAA9C;AACAC,cAAAA,MAAM,CAACC,aAAP,CAAqBL,KAArB;AACA,aAPD,MAOO;AACN7B,cAAAA,iBAAiB,CAACC,OAAlB,CAA0BG,QAA1B,CAAmC,aAAnC;AACAJ,cAAAA,iBAAiB,CAACC,OAAlB,CAA0BS,IAA1B,CAA+B,OAA/B,EAAwCC,IAAxC,CAA6CC,eAAe,CAACgB,+BAA7D;AACAQ,cAAAA,WAAW,CAACC,eAAZ,CAA4BX,QAAQ,CAACY,OAArC;AACA;;AACDtC,YAAAA,iBAAiB,CAACC,OAAlB,CAA0BsC,WAA1B,CAAsC,UAAtC;AACA;;AApBI;AAAA;AAAA,OAAN;AAuBA;;AA9EwB;AAAA;AAAA,CAA1B;AAiFArC,CAAC,CAAC4B,QAAD,CAAD,CAAYW,KAAZ,CAAkB,YAAM;AACvBzC,EAAAA,iBAAiB,CAACG,UAAlB;AACA,CAFD","sourcesContent":["/*\n * Copyright (C) MIKO LLC - All Rights Reserved\n * Unauthorized copying of this file, via any medium is strictly prohibited\n * Proprietary and confidential\n * Written by Nikolay Beketov, 10 2018\n *\n */\n\n/* global globalRootUrl, PbxApi, globalTranslate, UserMessage */\n\nconst pbxExtesionStatus = {\n\t$toggle: $('#module-status-toggle'),\n\tinitialize() {\n\t\tpbxExtesionStatus.$toggle\n\t\t\t.checkbox({\n\t\t\t\tonChecked() {\n\t\t\t\t\tconst uniqid = $(this).closest('.ui.toggle.checkbox').attr('data-value');\n\t\t\t\t\tpbxExtesionStatus.$toggle.addClass('disabled');\n\t\t\t\t\tpbxExtesionStatus.$toggle.find('label').text(globalTranslate.ext_ModuleStatusChanging);\n\t\t\t\t\tpbxExtesionStatus.enableModule(uniqid, PbxApi.SystemReloadModule);\n\t\t\t\t},\n\t\t\t\tonUnchecked() {\n\t\t\t\t\tconst uniqid = $(this).closest('.ui.toggle.checkbox').attr('data-value');\n\t\t\t\t\tpbxExtesionStatus.$toggle.find('label').text(globalTranslate.ext_ModuleStatusChanging);\n\t\t\t\t\tpbxExtesionStatus.$toggle.addClass('disabled');\n\t\t\t\t\tpbxExtesionStatus.disableModule(uniqid, PbxApi.SystemReloadModule);\n\t\t\t\t},\n\t\t\t});\n\t},\n\t/**\n\t * Включить модуль, с проверкой ссылочной целостности\n\t * @param params - параметры запроса.\n\t * @param cbAfterEnable - колбек функция\n\t */\n\tenableModule(uniqid, cbAfterEnable) {\n\t\t$.api({\n\t\t\turl: `${globalRootUrl}pbx-extension-modules/enable/{uniqid}`,\n\t\t\ton: 'now',\n\t\t\turlData: {\n\t\t\t\tuniqid,\n\t\t\t},\n\t\t\tonSuccess(response) {\n\t\t\t\tif (response.success) {\n\t\t\t\t\tpbxExtesionStatus.$toggle.checkbox('set checked');\n\t\t\t\t\tcbAfterEnable(uniqid);\n\t\t\t\t\tpbxExtesionStatus.$toggle.find('label').text(globalTranslate.ext_ModuleDisabledStatusEnabled);\n\t\t\t\t\tconst event = document.createEvent('Event');\n\t\t\t\t\tevent.initEvent('ModuleStatusChanged', false, true);\n\t\t\t\t\twindow.dispatchEvent(event);\n\t\t\t\t} else {\n\t\t\t\t\tpbxExtesionStatus.$toggle.checkbox('set unchecked');\n\t\t\t\t\tpbxExtesionStatus.$toggle.find('label').text(globalTranslate.ext_ModuleDisabledStatusDisabled);\n\t\t\t\t\tUserMessage.showMultiString(response.message);\n\t\t\t\t}\n\t\t\t\tpbxExtesionStatus.$toggle.removeClass('disabled');\n\t\t\t},\n\n\t\t});\n\t},\n\t/**\n\t * Выключить модуль, с проверкой ссылочной целостности\n\t * @param uniqid - ID модуля\n\t * @param cbAfterDisable - колбек функция\n\t */\n\tdisableModule(uniqid, cbAfterDisable) {\n\t\t$.api({\n\t\t\turl: `${globalRootUrl}pbx-extension-modules/disable/{uniqid}`,\n\t\t\ton: 'now',\n\t\t\turlData: {\n\t\t\t\tuniqid,\n\t\t\t},\n\t\t\tonSuccess(response) {\n\t\t\t\tif (response.success) {\n\t\t\t\t\tpbxExtesionStatus.$toggle.checkbox('set unchecked');\n\t\t\t\t\tcbAfterDisable(uniqid);\n\t\t\t\t\tpbxExtesionStatus.$toggle.find('label').text(globalTranslate.ext_ModuleDisabledStatusDisabled);\n\t\t\t\t\tconst event = document.createEvent('Event');\n\t\t\t\t\tevent.initEvent('ModuleStatusChanged', false, true);\n\t\t\t\t\twindow.dispatchEvent(event);\n\t\t\t\t} else {\n\t\t\t\t\tpbxExtesionStatus.$toggle.checkbox('set checked');\n\t\t\t\t\tpbxExtesionStatus.$toggle.find('label').text(globalTranslate.ext_ModuleDisabledStatusEnabled);\n\t\t\t\t\tUserMessage.showMultiString(response.message);\n\t\t\t\t}\n\t\t\t\tpbxExtesionStatus.$toggle.removeClass('disabled');\n\t\t\t},\n\n\t\t});\n\t},\n};\n\n$(document).ready(() => {\n\tpbxExtesionStatus.initialize();\n});\n"],"file":"pbx-extension-module-status.js"}
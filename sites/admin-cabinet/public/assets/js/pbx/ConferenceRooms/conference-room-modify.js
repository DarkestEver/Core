"use strict";

/*
 * Copyright (C) MIKO LLC - All Rights Reserved
 * Unauthorized copying of this file, via any medium is strictly prohibited
 * Proprietary and confidential
 * Written by Nikolay Beketov, 12 2019
 *
 */

/* global globalRootUrl,globalTranslate, Extensions, Form  */
// Проверка нет ли ошибки занятого другой учеткой номера
$.fn.form.settings.rules.existRule = function (value, parameter) {
  return $("#".concat(parameter)).hasClass('hidden');
};

var conference = {
  $number: $('#extension'),
  $formObj: $('#conference-room-form'),
  defaultExtension: '',
  validateRules: {
    name: {
      identifier: 'name',
      rules: [{
        type: 'empty',
        prompt: globalTranslate.cr_ValidateNameEmpty
      }]
    },
    extension: {
      identifier: 'extension',
      rules: [{
        type: 'empty',
        prompt: globalTranslate.cr_ValidateExtensionEmpty
      }, {
        type: 'existRule[extension-error]',
        prompt: globalTranslate.cr_ValidateExtensionDouble
      }]
    }
  },
  initialize: function () {
    function initialize() {
      // Динамическая проверка свободен ли внутренний номер
      conference.$number.on('change', function () {
        var newNumber = conference.$formObj.form('get value', 'extension');
        Extensions.checkAvailability(conference.defaultNumber, newNumber);
      });
      conference.initializeForm();
      conference.defaultExtension = conference.$formObj.form('get value', 'extension');
    }

    return initialize;
  }(),
  cbBeforeSendForm: function () {
    function cbBeforeSendForm(settings) {
      var result = settings;
      result.data = conference.$formObj.form('get values');
      return result;
    }

    return cbBeforeSendForm;
  }(),
  cbAfterSendForm: function () {
    function cbAfterSendForm() {}

    return cbAfterSendForm;
  }(),
  initializeForm: function () {
    function initializeForm() {
      Form.$formObj = conference.$formObj;
      Form.url = "".concat(globalRootUrl, "conference-rooms/save");
      Form.validateRules = conference.validateRules;
      Form.cbBeforeSendForm = conference.cbBeforeSendForm;
      Form.cbAfterSendForm = conference.cbAfterSendForm;
      Form.initialize();
    }

    return initializeForm;
  }()
};
$(document).ready(function () {
  conference.initialize();
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9Db25mZXJlbmNlUm9vbXMvY29uZmVyZW5jZS1yb29tLW1vZGlmeS5qcyJdLCJuYW1lcyI6WyIkIiwiZm4iLCJmb3JtIiwic2V0dGluZ3MiLCJydWxlcyIsImV4aXN0UnVsZSIsInZhbHVlIiwicGFyYW1ldGVyIiwiaGFzQ2xhc3MiLCJjb25mZXJlbmNlIiwiJG51bWJlciIsIiRmb3JtT2JqIiwiZGVmYXVsdEV4dGVuc2lvbiIsInZhbGlkYXRlUnVsZXMiLCJuYW1lIiwiaWRlbnRpZmllciIsInR5cGUiLCJwcm9tcHQiLCJnbG9iYWxUcmFuc2xhdGUiLCJjcl9WYWxpZGF0ZU5hbWVFbXB0eSIsImV4dGVuc2lvbiIsImNyX1ZhbGlkYXRlRXh0ZW5zaW9uRW1wdHkiLCJjcl9WYWxpZGF0ZUV4dGVuc2lvbkRvdWJsZSIsImluaXRpYWxpemUiLCJvbiIsIm5ld051bWJlciIsIkV4dGVuc2lvbnMiLCJjaGVja0F2YWlsYWJpbGl0eSIsImRlZmF1bHROdW1iZXIiLCJpbml0aWFsaXplRm9ybSIsImNiQmVmb3JlU2VuZEZvcm0iLCJyZXN1bHQiLCJkYXRhIiwiY2JBZnRlclNlbmRGb3JtIiwiRm9ybSIsInVybCIsImdsb2JhbFJvb3RVcmwiLCJkb2N1bWVudCIsInJlYWR5Il0sIm1hcHBpbmdzIjoiOztBQUFBOzs7Ozs7OztBQVFBO0FBRUE7QUFDQUEsQ0FBQyxDQUFDQyxFQUFGLENBQUtDLElBQUwsQ0FBVUMsUUFBVixDQUFtQkMsS0FBbkIsQ0FBeUJDLFNBQXpCLEdBQXFDLFVBQUNDLEtBQUQsRUFBUUMsU0FBUjtBQUFBLFNBQXNCUCxDQUFDLFlBQUtPLFNBQUwsRUFBRCxDQUFtQkMsUUFBbkIsQ0FBNEIsUUFBNUIsQ0FBdEI7QUFBQSxDQUFyQzs7QUFFQSxJQUFNQyxVQUFVLEdBQUc7QUFDbEJDLEVBQUFBLE9BQU8sRUFBRVYsQ0FBQyxDQUFDLFlBQUQsQ0FEUTtBQUVsQlcsRUFBQUEsUUFBUSxFQUFFWCxDQUFDLENBQUMsdUJBQUQsQ0FGTztBQUdsQlksRUFBQUEsZ0JBQWdCLEVBQUUsRUFIQTtBQUlsQkMsRUFBQUEsYUFBYSxFQUFFO0FBQ2RDLElBQUFBLElBQUksRUFBRTtBQUNMQyxNQUFBQSxVQUFVLEVBQUUsTUFEUDtBQUVMWCxNQUFBQSxLQUFLLEVBQUUsQ0FDTjtBQUNDWSxRQUFBQSxJQUFJLEVBQUUsT0FEUDtBQUVDQyxRQUFBQSxNQUFNLEVBQUVDLGVBQWUsQ0FBQ0M7QUFGekIsT0FETTtBQUZGLEtBRFE7QUFVZEMsSUFBQUEsU0FBUyxFQUFFO0FBQ1ZMLE1BQUFBLFVBQVUsRUFBRSxXQURGO0FBRVZYLE1BQUFBLEtBQUssRUFBRSxDQUNOO0FBQ0NZLFFBQUFBLElBQUksRUFBRSxPQURQO0FBRUNDLFFBQUFBLE1BQU0sRUFBRUMsZUFBZSxDQUFDRztBQUZ6QixPQURNLEVBS047QUFDQ0wsUUFBQUEsSUFBSSxFQUFFLDRCQURQO0FBRUNDLFFBQUFBLE1BQU0sRUFBRUMsZUFBZSxDQUFDSTtBQUZ6QixPQUxNO0FBRkc7QUFWRyxHQUpHO0FBNEJsQkMsRUFBQUEsVUE1QmtCO0FBQUEsMEJBNEJMO0FBQ1o7QUFDQWQsTUFBQUEsVUFBVSxDQUFDQyxPQUFYLENBQW1CYyxFQUFuQixDQUFzQixRQUF0QixFQUFnQyxZQUFNO0FBQ3JDLFlBQU1DLFNBQVMsR0FBR2hCLFVBQVUsQ0FBQ0UsUUFBWCxDQUFvQlQsSUFBcEIsQ0FBeUIsV0FBekIsRUFBc0MsV0FBdEMsQ0FBbEI7QUFDQXdCLFFBQUFBLFVBQVUsQ0FBQ0MsaUJBQVgsQ0FBNkJsQixVQUFVLENBQUNtQixhQUF4QyxFQUF1REgsU0FBdkQ7QUFDQSxPQUhEO0FBS0FoQixNQUFBQSxVQUFVLENBQUNvQixjQUFYO0FBQ0FwQixNQUFBQSxVQUFVLENBQUNHLGdCQUFYLEdBQThCSCxVQUFVLENBQUNFLFFBQVgsQ0FBb0JULElBQXBCLENBQXlCLFdBQXpCLEVBQXNDLFdBQXRDLENBQTlCO0FBQ0E7O0FBckNpQjtBQUFBO0FBc0NsQjRCLEVBQUFBLGdCQXRDa0I7QUFBQSw4QkFzQ0QzQixRQXRDQyxFQXNDUztBQUMxQixVQUFNNEIsTUFBTSxHQUFHNUIsUUFBZjtBQUNBNEIsTUFBQUEsTUFBTSxDQUFDQyxJQUFQLEdBQWN2QixVQUFVLENBQUNFLFFBQVgsQ0FBb0JULElBQXBCLENBQXlCLFlBQXpCLENBQWQ7QUFDQSxhQUFPNkIsTUFBUDtBQUNBOztBQTFDaUI7QUFBQTtBQTJDbEJFLEVBQUFBLGVBM0NrQjtBQUFBLCtCQTJDQSxDQUVqQjs7QUE3Q2lCO0FBQUE7QUE4Q2xCSixFQUFBQSxjQTlDa0I7QUFBQSw4QkE4Q0Q7QUFDaEJLLE1BQUFBLElBQUksQ0FBQ3ZCLFFBQUwsR0FBZ0JGLFVBQVUsQ0FBQ0UsUUFBM0I7QUFDQXVCLE1BQUFBLElBQUksQ0FBQ0MsR0FBTCxhQUFjQyxhQUFkO0FBQ0FGLE1BQUFBLElBQUksQ0FBQ3JCLGFBQUwsR0FBcUJKLFVBQVUsQ0FBQ0ksYUFBaEM7QUFDQXFCLE1BQUFBLElBQUksQ0FBQ0osZ0JBQUwsR0FBd0JyQixVQUFVLENBQUNxQixnQkFBbkM7QUFDQUksTUFBQUEsSUFBSSxDQUFDRCxlQUFMLEdBQXVCeEIsVUFBVSxDQUFDd0IsZUFBbEM7QUFDQUMsTUFBQUEsSUFBSSxDQUFDWCxVQUFMO0FBQ0E7O0FBckRpQjtBQUFBO0FBQUEsQ0FBbkI7QUF3REF2QixDQUFDLENBQUNxQyxRQUFELENBQUQsQ0FBWUMsS0FBWixDQUFrQixZQUFNO0FBQ3ZCN0IsRUFBQUEsVUFBVSxDQUFDYyxVQUFYO0FBQ0EsQ0FGRCIsInNvdXJjZXNDb250ZW50IjpbIi8qXG4gKiBDb3B5cmlnaHQgKEMpIE1JS08gTExDIC0gQWxsIFJpZ2h0cyBSZXNlcnZlZFxuICogVW5hdXRob3JpemVkIGNvcHlpbmcgb2YgdGhpcyBmaWxlLCB2aWEgYW55IG1lZGl1bSBpcyBzdHJpY3RseSBwcm9oaWJpdGVkXG4gKiBQcm9wcmlldGFyeSBhbmQgY29uZmlkZW50aWFsXG4gKiBXcml0dGVuIGJ5IE5pa29sYXkgQmVrZXRvdiwgMTIgMjAxOVxuICpcbiAqL1xuXG4vKiBnbG9iYWwgZ2xvYmFsUm9vdFVybCxnbG9iYWxUcmFuc2xhdGUsIEV4dGVuc2lvbnMsIEZvcm0gICovXG5cbi8vINCf0YDQvtCy0LXRgNC60LAg0L3QtdGCINC70Lgg0L7RiNC40LHQutC4INC30LDQvdGP0YLQvtCz0L4g0LTRgNGD0LPQvtC5INGD0YfQtdGC0LrQvtC5INC90L7QvNC10YDQsFxuJC5mbi5mb3JtLnNldHRpbmdzLnJ1bGVzLmV4aXN0UnVsZSA9ICh2YWx1ZSwgcGFyYW1ldGVyKSA9PiAkKGAjJHtwYXJhbWV0ZXJ9YCkuaGFzQ2xhc3MoJ2hpZGRlbicpO1xuXG5jb25zdCBjb25mZXJlbmNlID0ge1xuXHQkbnVtYmVyOiAkKCcjZXh0ZW5zaW9uJyksXG5cdCRmb3JtT2JqOiAkKCcjY29uZmVyZW5jZS1yb29tLWZvcm0nKSxcblx0ZGVmYXVsdEV4dGVuc2lvbjogJycsXG5cdHZhbGlkYXRlUnVsZXM6IHtcblx0XHRuYW1lOiB7XG5cdFx0XHRpZGVudGlmaWVyOiAnbmFtZScsXG5cdFx0XHRydWxlczogW1xuXHRcdFx0XHR7XG5cdFx0XHRcdFx0dHlwZTogJ2VtcHR5Jyxcblx0XHRcdFx0XHRwcm9tcHQ6IGdsb2JhbFRyYW5zbGF0ZS5jcl9WYWxpZGF0ZU5hbWVFbXB0eSxcblx0XHRcdFx0fSxcblx0XHRcdF0sXG5cdFx0fSxcblx0XHRleHRlbnNpb246IHtcblx0XHRcdGlkZW50aWZpZXI6ICdleHRlbnNpb24nLFxuXHRcdFx0cnVsZXM6IFtcblx0XHRcdFx0e1xuXHRcdFx0XHRcdHR5cGU6ICdlbXB0eScsXG5cdFx0XHRcdFx0cHJvbXB0OiBnbG9iYWxUcmFuc2xhdGUuY3JfVmFsaWRhdGVFeHRlbnNpb25FbXB0eSxcblx0XHRcdFx0fSxcblx0XHRcdFx0e1xuXHRcdFx0XHRcdHR5cGU6ICdleGlzdFJ1bGVbZXh0ZW5zaW9uLWVycm9yXScsXG5cdFx0XHRcdFx0cHJvbXB0OiBnbG9iYWxUcmFuc2xhdGUuY3JfVmFsaWRhdGVFeHRlbnNpb25Eb3VibGUsXG5cdFx0XHRcdH0sXG5cdFx0XHRdLFxuXHRcdH0sXG5cdH0sXG5cdGluaXRpYWxpemUoKSB7XG5cdFx0Ly8g0JTQuNC90LDQvNC40YfQtdGB0LrQsNGPINC/0YDQvtCy0LXRgNC60LAg0YHQstC+0LHQvtC00LXQvSDQu9C4INCy0L3Rg9GC0YDQtdC90L3QuNC5INC90L7QvNC10YBcblx0XHRjb25mZXJlbmNlLiRudW1iZXIub24oJ2NoYW5nZScsICgpID0+IHtcblx0XHRcdGNvbnN0IG5ld051bWJlciA9IGNvbmZlcmVuY2UuJGZvcm1PYmouZm9ybSgnZ2V0IHZhbHVlJywgJ2V4dGVuc2lvbicpO1xuXHRcdFx0RXh0ZW5zaW9ucy5jaGVja0F2YWlsYWJpbGl0eShjb25mZXJlbmNlLmRlZmF1bHROdW1iZXIsIG5ld051bWJlcik7XG5cdFx0fSk7XG5cblx0XHRjb25mZXJlbmNlLmluaXRpYWxpemVGb3JtKCk7XG5cdFx0Y29uZmVyZW5jZS5kZWZhdWx0RXh0ZW5zaW9uID0gY29uZmVyZW5jZS4kZm9ybU9iai5mb3JtKCdnZXQgdmFsdWUnLCAnZXh0ZW5zaW9uJyk7XG5cdH0sXG5cdGNiQmVmb3JlU2VuZEZvcm0oc2V0dGluZ3MpIHtcblx0XHRjb25zdCByZXN1bHQgPSBzZXR0aW5ncztcblx0XHRyZXN1bHQuZGF0YSA9IGNvbmZlcmVuY2UuJGZvcm1PYmouZm9ybSgnZ2V0IHZhbHVlcycpO1xuXHRcdHJldHVybiByZXN1bHQ7XG5cdH0sXG5cdGNiQWZ0ZXJTZW5kRm9ybSgpIHtcblxuXHR9LFxuXHRpbml0aWFsaXplRm9ybSgpIHtcblx0XHRGb3JtLiRmb3JtT2JqID0gY29uZmVyZW5jZS4kZm9ybU9iajtcblx0XHRGb3JtLnVybCA9IGAke2dsb2JhbFJvb3RVcmx9Y29uZmVyZW5jZS1yb29tcy9zYXZlYDtcblx0XHRGb3JtLnZhbGlkYXRlUnVsZXMgPSBjb25mZXJlbmNlLnZhbGlkYXRlUnVsZXM7XG5cdFx0Rm9ybS5jYkJlZm9yZVNlbmRGb3JtID0gY29uZmVyZW5jZS5jYkJlZm9yZVNlbmRGb3JtO1xuXHRcdEZvcm0uY2JBZnRlclNlbmRGb3JtID0gY29uZmVyZW5jZS5jYkFmdGVyU2VuZEZvcm07XG5cdFx0Rm9ybS5pbml0aWFsaXplKCk7XG5cdH0sXG59O1xuXG4kKGRvY3VtZW50KS5yZWFkeSgoKSA9PiB7XG5cdGNvbmZlcmVuY2UuaW5pdGlhbGl6ZSgpO1xufSk7XG5cbiJdfQ==
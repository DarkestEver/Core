"use strict";

/*
 * Copyright (C) MIKO LLC - All Rights Reserved
 * Unauthorized copying of this file, via any medium is strictly prohibited
 * Proprietary and confidential
 * Written by Nikolay Beketov, 12 2019
 *
 */

/* global globalRootUrl,globalTranslate, Form, PbxApi */
var networks = {
  $getMyIpButton: $('#getmyip'),
  $formObj: $('#network-form'),
  $dropDowns: $('#network-form .dropdown'),
  vlansArray: {},
  validateRules: {
    gateway: {
      optional: true,
      rules: [{
        type: 'ipaddr',
        prompt: globalTranslate.nw_ValidateIppaddrNotRight
      }]
    },
    primarydns: {
      optional: true,
      rules: [{
        type: 'ipaddr',
        prompt: globalTranslate.nw_ValidateIppaddrNotRight
      }]
    },
    secondarydns: {
      optional: true,
      rules: [{
        type: 'ipaddr',
        prompt: globalTranslate.nw_ValidateIppaddrNotRight
      }]
    },
    extipaddr: {
      optional: true,
      rules: [{
        type: 'ipaddrWithPortOptional',
        prompt: globalTranslate.nw_ValidateExtIppaddrNotRight
      }, {
        type: 'extenalIpHost',
        prompt: globalTranslate.nw_ValidateExtIppaddrOrHostIsEmpty
      }]
    },
    exthostname: {
      depends: 'usenat',
      rules: [{
        type: 'extenalIpHost',
        prompt: globalTranslate.nw_ValidateExtIppaddrOrHostIsEmpty
      }]
    }
  },
  initialize: function () {
    function initialize() {
      networks.toggleDisabledFieldClass();
      $('#eth-interfaces-menu .item').tab();
      $('#usenat-checkbox').checkbox({
        onChange: function () {
          function onChange() {
            networks.toggleDisabledFieldClass();
          }

          return onChange;
        }()
      });
      networks.$dropDowns.dropdown();
      $('.dhcp-checkbox').checkbox({
        onChange: function () {
          function onChange() {
            networks.toggleDisabledFieldClass();
          }

          return onChange;
        }()
      });
      networks.$getMyIpButton.on('click', function (e) {
        e.preventDefault();
        networks.$getMyIpButton.addClass('loading disabled');
        PbxApi.GetExternalIp(networks.cbAfterGetExternalIp);
      }); // Удаление дополнительного сетевого интерфейса

      $('.delete-interface').api({
        url: "".concat(globalRootUrl, "network/delete/{value}"),
        method: 'POST',
        beforeSend: function () {
          function beforeSend(settings) {
            $(this).addClass('loading disabled');
            return settings;
          }

          return beforeSend;
        }(),
        onSuccess: function () {
          function onSuccess(response) {
            $(this).removeClass('loading disabled');
            $('.ui.message.ajax').remove();
            $.each(response.message, function (index, value) {
              networks.$formObj.after("<div class=\"ui ".concat(index, " message ajax\">").concat(value, "</div>"));
            });
            if (response.success) window.location.reload();
          }

          return onSuccess;
        }(),
        onFailure: function () {
          function onFailure(response) {
            $(this).removeClass('loading disabled');
            $('form').after(response);
          }

          return onFailure;
        }()
      }); // Очистка настроек дополнительного сетевого

      $('.delete-interface-new').on('click', function () {
        var initialValues = {
          interface_new: '',
          name_new: '',
          dhcp_new: 'on',
          ipaddr_new: '',
          subnet_new: '0'
        };
        networks.$formObj.form('set values', initialValues);
        $('#interface_new').dropdown('restore defaults');
        $('#dhcp-new-checkbox').checkbox('check');
        $('#eth-interfaces-menu .item').tab('change tab', $('#eth-interfaces-menu a.item').first().attr('data-tab'));
      });
      networks.initializeForm();
    }

    return initialize;
  }(),

  /**
   * Обработчик API функции по возврату структуры с IP адресом маршрутизатора
   */
  cbAfterGetExternalIp: function () {
    function cbAfterGetExternalIp(response) {
      if (response === false) {
        networks.$getMyIpButton.removeClass('loading disabled');
      } else {
        networks.$formObj.form('set value', 'extipaddr', response.ip);
        networks.$getMyIpButton.removeClass('loading disabled');
      }
    }

    return cbAfterGetExternalIp;
  }(),
  toggleDisabledFieldClass: function () {
    function toggleDisabledFieldClass() {
      $('#eth-interfaces-menu a').each(function (index, obj) {
        var eth = $(obj).attr('data-tab');

        if ($("#dhcp-".concat(eth, "-checkbox")).checkbox('is unchecked')) {
          $("#ip-address-group-".concat(eth)).removeClass('disabled');
          $("#not-dhcp-".concat(eth)).val('1');
        } else {
          $("#ip-address-group-".concat(eth)).addClass('disabled');
          $("#not-dhcp-".concat(eth)).val('');
        }

        networks.addNewFormRules(eth);
      });

      if ($('#usenat-checkbox').checkbox('is checked')) {
        $('.nated-settings-group').removeClass('disabled');
      } else {
        $('.nated-settings-group').addClass('disabled');
      }
    }

    return toggleDisabledFieldClass;
  }(),
  addNewFormRules: function () {
    function addNewFormRules(newRowId) {
      var nameClass = "name_".concat(newRowId);
      networks.validateRules[nameClass] = {
        identifier: nameClass,
        depends: "interface_".concat(newRowId),
        rules: [{
          type: 'empty',
          prompt: globalTranslate.nw_ValidateNameIsNotBeEmpty
        }]
      };
      var vlanClass = "vlanid_".concat(newRowId);
      networks.validateRules[vlanClass] = {
        depends: "interface_".concat(newRowId),
        identifier: vlanClass,
        rules: [{
          type: 'integer[0..4095]',
          prompt: globalTranslate.nw_ValidateVlanRange
        }, {
          type: "checkVlan[".concat(newRowId, "]"),
          prompt: globalTranslate.nw_ValidateVlanCross
        }]
      };
      var ipaddrClass = "ipaddr_".concat(newRowId);
      networks.validateRules[ipaddrClass] = {
        identifier: ipaddrClass,
        depends: "not-dhcp-".concat(newRowId),
        rules: [{
          type: 'empty',
          prompt: globalTranslate.nw_ValidateIppaddrIsEmpty
        }, {
          type: 'ipaddr',
          prompt: globalTranslate.nw_ValidateIppaddrNotRight
        }]
      };
      var dhcpClass = "dhcp_".concat(newRowId);
      networks.validateRules[dhcpClass] = {
        identifier: dhcpClass,
        depends: "interface_".concat(newRowId),
        rules: [{
          type: "dhcpOnVlanNetworks[".concat(newRowId, "]"),
          prompt: globalTranslate.nw_ValidateDHCPOnVlansDontSupport
        }]
      };
    }

    return addNewFormRules;
  }(),
  cbBeforeSendForm: function () {
    function cbBeforeSendForm(settings) {
      var result = settings;
      result.data = networks.$formObj.form('get values');
      return result;
    }

    return cbBeforeSendForm;
  }(),
  cbAfterSendForm: function () {
    function cbAfterSendForm() {}

    return cbAfterSendForm;
  }(),
  initializeForm: function () {
    function initializeForm() {
      Form.$formObj = networks.$formObj;
      Form.url = "".concat(globalRootUrl, "network/save");
      Form.validateRules = networks.validateRules;
      Form.cbBeforeSendForm = networks.cbBeforeSendForm;
      Form.cbAfterSendForm = networks.cbAfterSendForm;
      Form.initialize();
    }

    return initializeForm;
  }()
};

$.fn.form.settings.rules.ipaddr = function (value) {
  var result = true;
  var f = value.match(/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/);

  if (f == null) {
    result = false;
  } else {
    for (var i = 1; i < 5; i += 1) {
      var a = f[i];

      if (a > 255) {
        result = false;
      }
    }

    if (f[5] > 32) {
      result = false;
    }
  }

  return result;
};

$.fn.form.settings.rules.ipaddrWithPortOptional = function (value) {
  var result = true;
  var f = value.match(/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})(:[0-9]+)?$/);

  if (f == null) {
    result = false;
  } else {
    for (var i = 1; i < 5; i += 1) {
      var a = f[i];

      if (a > 255) {
        result = false;
      }
    }

    if (f[5] > 32) {
      result = false;
    }
  }

  return result;
};

$.fn.form.settings.rules.checkVlan = function (vlanValue, param) {
  var result = true;
  var vlansArray = {};
  var allValues = networks.$formObj.form('get values');

  if (allValues.interface_new !== undefined && allValues.interface_new > 0) {
    var newEthName = allValues["interface_".concat(allValues.interface_new)];
    vlansArray[newEthName] = [allValues.vlanid_new];

    if (allValues.vlanid_new === '') {
      result = false;
    }
  }

  $.each(allValues, function (index, value) {
    if (index === 'interface_new' || index === 'vlanid_new') return;

    if (index.indexOf('vlanid') >= 0) {
      var ethName = allValues["interface_".concat(index.split('_')[1])];

      if ($.inArray(value, vlansArray[ethName]) >= 0 && vlanValue === value && param === index.split('_')[1]) {
        result = false;
      } else {
        if (!(ethName in vlansArray)) {
          vlansArray[ethName] = [];
        }

        vlansArray[ethName].push(value);
      }
    }
  });
  return result;
};

$.fn.form.settings.rules.dhcpOnVlanNetworks = function (value, param) {
  var result = true;
  var vlanValue = networks.$formObj.form('get value', "vlanid_".concat(param));
  var dhcpValue = networks.$formObj.form('get value', "dhcp_".concat(param));

  if (vlanValue > 0 && dhcpValue === 'on') {
    result = false;
  }

  return result;
};

$.fn.form.settings.rules.extenalIpHost = function () {
  var allValues = networks.$formObj.form('get values');

  if (allValues.usenat === 'on') {
    if (allValues.exthostname === '' && allValues.extipaddr === '') {
      return false;
    }
  }

  return true;
};

$(document).ready(function () {
  networks.initialize();
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9OZXR3b3JrL25ldHdvcmstbW9kaWZ5LmpzIl0sIm5hbWVzIjpbIm5ldHdvcmtzIiwiJGdldE15SXBCdXR0b24iLCIkIiwiJGZvcm1PYmoiLCIkZHJvcERvd25zIiwidmxhbnNBcnJheSIsInZhbGlkYXRlUnVsZXMiLCJnYXRld2F5Iiwib3B0aW9uYWwiLCJydWxlcyIsInR5cGUiLCJwcm9tcHQiLCJnbG9iYWxUcmFuc2xhdGUiLCJud19WYWxpZGF0ZUlwcGFkZHJOb3RSaWdodCIsInByaW1hcnlkbnMiLCJzZWNvbmRhcnlkbnMiLCJleHRpcGFkZHIiLCJud19WYWxpZGF0ZUV4dElwcGFkZHJOb3RSaWdodCIsIm53X1ZhbGlkYXRlRXh0SXBwYWRkck9ySG9zdElzRW1wdHkiLCJleHRob3N0bmFtZSIsImRlcGVuZHMiLCJpbml0aWFsaXplIiwidG9nZ2xlRGlzYWJsZWRGaWVsZENsYXNzIiwidGFiIiwiY2hlY2tib3giLCJvbkNoYW5nZSIsImRyb3Bkb3duIiwib24iLCJlIiwicHJldmVudERlZmF1bHQiLCJhZGRDbGFzcyIsIlBieEFwaSIsIkdldEV4dGVybmFsSXAiLCJjYkFmdGVyR2V0RXh0ZXJuYWxJcCIsImFwaSIsInVybCIsImdsb2JhbFJvb3RVcmwiLCJtZXRob2QiLCJiZWZvcmVTZW5kIiwic2V0dGluZ3MiLCJvblN1Y2Nlc3MiLCJyZXNwb25zZSIsInJlbW92ZUNsYXNzIiwicmVtb3ZlIiwiZWFjaCIsIm1lc3NhZ2UiLCJpbmRleCIsInZhbHVlIiwiYWZ0ZXIiLCJzdWNjZXNzIiwid2luZG93IiwibG9jYXRpb24iLCJyZWxvYWQiLCJvbkZhaWx1cmUiLCJpbml0aWFsVmFsdWVzIiwiaW50ZXJmYWNlX25ldyIsIm5hbWVfbmV3IiwiZGhjcF9uZXciLCJpcGFkZHJfbmV3Iiwic3VibmV0X25ldyIsImZvcm0iLCJmaXJzdCIsImF0dHIiLCJpbml0aWFsaXplRm9ybSIsImlwIiwib2JqIiwiZXRoIiwidmFsIiwiYWRkTmV3Rm9ybVJ1bGVzIiwibmV3Um93SWQiLCJuYW1lQ2xhc3MiLCJpZGVudGlmaWVyIiwibndfVmFsaWRhdGVOYW1lSXNOb3RCZUVtcHR5IiwidmxhbkNsYXNzIiwibndfVmFsaWRhdGVWbGFuUmFuZ2UiLCJud19WYWxpZGF0ZVZsYW5Dcm9zcyIsImlwYWRkckNsYXNzIiwibndfVmFsaWRhdGVJcHBhZGRySXNFbXB0eSIsImRoY3BDbGFzcyIsIm53X1ZhbGlkYXRlREhDUE9uVmxhbnNEb250U3VwcG9ydCIsImNiQmVmb3JlU2VuZEZvcm0iLCJyZXN1bHQiLCJkYXRhIiwiY2JBZnRlclNlbmRGb3JtIiwiRm9ybSIsImZuIiwiaXBhZGRyIiwiZiIsIm1hdGNoIiwiaSIsImEiLCJpcGFkZHJXaXRoUG9ydE9wdGlvbmFsIiwiY2hlY2tWbGFuIiwidmxhblZhbHVlIiwicGFyYW0iLCJhbGxWYWx1ZXMiLCJ1bmRlZmluZWQiLCJuZXdFdGhOYW1lIiwidmxhbmlkX25ldyIsImluZGV4T2YiLCJldGhOYW1lIiwic3BsaXQiLCJpbkFycmF5IiwicHVzaCIsImRoY3BPblZsYW5OZXR3b3JrcyIsImRoY3BWYWx1ZSIsImV4dGVuYWxJcEhvc3QiLCJ1c2VuYXQiLCJkb2N1bWVudCIsInJlYWR5Il0sIm1hcHBpbmdzIjoiOztBQUFBOzs7Ozs7OztBQVFBO0FBRUEsSUFBTUEsUUFBUSxHQUFHO0FBQ2hCQyxFQUFBQSxjQUFjLEVBQUVDLENBQUMsQ0FBQyxVQUFELENBREQ7QUFFaEJDLEVBQUFBLFFBQVEsRUFBRUQsQ0FBQyxDQUFDLGVBQUQsQ0FGSztBQUdoQkUsRUFBQUEsVUFBVSxFQUFFRixDQUFDLENBQUMseUJBQUQsQ0FIRztBQUloQkcsRUFBQUEsVUFBVSxFQUFFLEVBSkk7QUFLaEJDLEVBQUFBLGFBQWEsRUFBRTtBQUNkQyxJQUFBQSxPQUFPLEVBQUU7QUFDUkMsTUFBQUEsUUFBUSxFQUFFLElBREY7QUFFUkMsTUFBQUEsS0FBSyxFQUFFLENBQ047QUFDQ0MsUUFBQUEsSUFBSSxFQUFFLFFBRFA7QUFFQ0MsUUFBQUEsTUFBTSxF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UyxDQUFDNUUsV0FBVixLQUEwQixFQUExQixJQUFnQzRFLFNBQVMsQ0FBQy9FLFNBQVYsS0FBd0IsRUFBNUQsRUFBZ0U7QUFDL0QsYUFBTyxLQUFQO0FBQ0E7QUFDRDs7QUFDRCxTQUFPLElBQVA7QUFDQSxDQVJEOztBQVVBZCxDQUFDLENBQUMwRyxRQUFELENBQUQsQ0FBWUMsS0FBWixDQUFrQixZQUFNO0FBQ3ZCN0csRUFBQUEsUUFBUSxDQUFDcUIsVUFBVDtBQUNBLENBRkQiLCJzb3VyY2VzQ29udGVudCI6WyIvKlxuICogQ29weXJpZ2h0IChDKSBNSUtPIExMQyAtIEFsbCBSaWdodHMgUmVzZXJ2ZWRcbiAqIFVuYXV0aG9yaXplZCBjb3B5aW5nIG9mIHRoaXMgZmlsZSwgdmlhIGFueSBtZWRpdW0gaXMgc3RyaWN0bHkgcHJvaGliaXRlZFxuICogUHJvcHJpZXRhcnkgYW5kIGNvbmZpZGVudGlhbFxuICogV3JpdHRlbiBieSBOaWtvbGF5IEJla2V0b3YsIDEyIDIwMTlcbiAqXG4gKi9cblxuLyogZ2xvYmFsIGdsb2JhbFJvb3RVcmwsZ2xvYmFsVHJhbnNsYXRlLCBGb3JtLCBQYnhBcGkgKi9cblxuY29uc3QgbmV0d29ya3MgPSB7XG5cdCRnZXRNeUlwQnV0dG9uOiAkKCcjZ2V0bXlpcCcpLFxuXHQkZm9ybU9iajogJCgnI25ldHdvcmstZm9ybScpLFxuXHQkZHJvcERvd25zOiAkKCcjbmV0d29yay1mb3JtIC5kcm9wZG93bicpLFxuXHR2bGFuc0FycmF5OiB7fSxcblx0dmFsaWRhdGVSdWxlczoge1xuXHRcdGdhdGV3YXk6IHtcblx0XHRcdG9wdGlvbmFsOiB0cnVlLFxuXHRcdFx0cnVsZXM6IFtcblx0XHRcdFx0e1xuXHRcdFx0XHRcdHR5cGU6ICdpcGFkZHInLFxuXHRcdFx0XHRcdHByb21wdDogZ2xvYmFsVHJhbnNsYXRlLm53X1ZhbGlkYXRlSXBwYWRkck5vdFJpZ2h0LFxuXHRcdFx0XHR9LFxuXHRcdFx0XSxcblx0XHR9LFxuXHRcdHByaW1hcnlkbnM6IHtcblx0XHRcdG9wdGlvbmFsOiB0cnVlLFxuXHRcdFx0cnVsZXM6IFtcblx0XHRcdFx0e1xuXHRcdFx0XHRcdHR5cGU6ICdpcGFkZHInLFxuXHRcdFx0XHRcdHByb21wdDogZ2xvYmFsVHJhbnNsYXRlLm53X1ZhbGlkYXRlSXBwYWRkck5vdFJpZ2h0LFxuXHRcdFx0XHR9LFxuXHRcdFx0XSxcblx0XHR9LFxuXHRcdHNlY29uZGFyeWRuczoge1xuXHRcdFx0b3B0aW9uYWw6IHRydWUsXG5cdFx0XHRydWxlczogW1xuXHRcdFx0XHR7XG5cdFx0XHRcdFx0dHlwZTogJ2lwYWRkcicsXG5cdFx0XHRcdFx0cHJvbXB0OiBnbG9iYWxUcmFuc2xhdGUubndfVmFsaWRhdGVJcHBhZGRyTm90UmlnaHQsXG5cdFx0XHRcdH0sXG5cdFx0XHRdLFxuXHRcdH0sXG5cdFx0ZXh0aXBhZGRyOiB7XG5cdFx0XHRvcHRpb25hbDogdHJ1ZSxcblx0XHRcdHJ1bGVzOiBbXG5cdFx0XHRcdHtcblx0XHRcdFx0XHR0eXBlOiAnaXBhZGRyV2l0aFBvcnRPcHRpb25hbCcsXG5cdFx0XHRcdFx0cHJvbXB0OiBnbG9iYWxUcmFuc2xhdGUubndfVmFsaWRhdGVFeHRJcHBhZGRyTm90UmlnaHQsXG5cdFx0XHRcdH0sXG5cdFx0XHRcdHtcblx0XHRcdFx0XHR0eXBlOiAnZXh0ZW5hbElwSG9zdCcsXG5cdFx0XHRcdFx0cHJvbXB0OiBnbG9iYWxUcmFuc2xhdGUubndfVmFsaWRhdGVFeHRJcHBhZGRyT3JIb3N0SXNFbXB0eSxcblx0XHRcdFx0fSxcblx0XHRcdF0sXG5cdFx0fSxcblx0XHRleHRob3N0bmFtZToge1xuXHRcdFx0ZGVwZW5kczogJ3VzZW5hdCcsXG5cdFx0XHRydWxlczogW1xuXHRcdFx0XHR7XG5cdFx0XHRcdFx0dHlwZTogJ2V4dGVuYWxJcEhvc3QnLFxuXHRcdFx0XHRcdHByb21wdDogZ2xvYmFsVHJhbnNsYXRlLm53X1ZhbGlkYXRlRXh0SXBwYWRkck9ySG9zdElzRW1wdHksXG5cdFx0XHRcdH0sXG5cdFx0XHRdLFxuXHRcdH0sXG5cdH0sXG5cdGluaXRpYWxpemUoKSB7XG5cdFx0bmV0d29ya3MudG9nZ2xlRGlzYWJsZWRGaWVsZENsYXNzKCk7XG5cdFx0JCgnI2V0aC1pbnRlcmZhY2VzLW1lbnUgLml0ZW0nKS50YWIoKTtcblxuXHRcdCQoJyN1c2VuYXQtY2hlY2tib3gnKS5jaGVja2JveCh7XG5cdFx0XHRvbkNoYW5nZSgpIHtcblx0XHRcdFx0bmV0d29ya3MudG9nZ2xlRGlzYWJsZWRGaWVsZENsYXNzKCk7XG5cdFx0XHR9LFxuXHRcdH0pO1xuXHRcdG5ldHdvcmtzLiRkcm9wRG93bnMuZHJvcGRvd24oKTtcblx0XHQkKCcuZGhjcC1jaGVja2JveCcpXG5cdFx0XHQuY2hlY2tib3goe1xuXHRcdFx0XHRvbkNoYW5nZSgpIHtcblx0XHRcdFx0XHRuZXR3b3Jrcy50b2dnbGVEaXNhYmxlZEZpZWxkQ2xhc3MoKTtcblx0XHRcdFx0fSxcblx0XHRcdH0pO1xuXHRcdG5ldHdvcmtzLiRnZXRNeUlwQnV0dG9uLm9uKCdjbGljaycsIChlKSA9PiB7XG5cdFx0XHRlLnByZXZlbnREZWZhdWx0KCk7XG5cdFx0XHRuZXR3b3Jrcy4kZ2V0TXlJcEJ1dHRvbi5hZGRDbGFzcygnbG9hZGluZyBkaXNhYmxlZCcpO1xuXHRcdFx0UGJ4QXBpLkdldEV4dGVybmFsSXAobmV0d29ya3MuY2JBZnRlckdldEV4dGVybmFsSXApO1xuXHRcdH0pO1xuXG5cdFx0Ly8g0KPQtNCw0LvQtdC90LjQtSDQtNC+0L/QvtC70L3QuNGC0LXQu9GM0L3QvtCz0L4g0YHQtdGC0LXQstC+0LPQviDQuNC90YLQtdGA0YTQtdC50YHQsFxuXHRcdCQoJy5kZWxldGUtaW50ZXJmYWNlJykuYXBpKHtcblx0XHRcdHVybDogYCR7Z2xvYmFsUm9vdFVybH1uZXR3b3JrL2RlbGV0ZS97dmFsdWV9YCxcblx0XHRcdG1ldGhvZDogJ1BPU1QnLFxuXHRcdFx0YmVmb3JlU2VuZChzZXR0aW5ncykge1xuXHRcdFx0XHQkKHRoaXMpLmFkZENsYXNzKCdsb2FkaW5nIGRpc2FibGVkJyk7XG5cdFx0XHRcdHJldHVybiBzZXR0aW5ncztcblx0XHRcdH0sXG5cblx0XHRcdG9uU3VjY2VzcyhyZXNwb25zZSkge1xuXHRcdFx0XHQkKHRoaXMpLnJlbW92ZUNsYXNzKCdsb2FkaW5nIGRpc2FibGVkJyk7XG5cdFx0XHRcdCQoJy51aS5tZXNzYWdlLmFqYXgnKS5yZW1vdmUoKTtcblx0XHRcdFx0JC5lYWNoKHJlc3BvbnNlLm1lc3NhZ2UsIChpbmRleCwgdmFsdWUpID0+IHtcblx0XHRcdFx0XHRuZXR3b3Jrcy4kZm9ybU9iai5hZnRlcihgPGRpdiBjbGFzcz1cInVpICR7aW5kZXh9IG1lc3NhZ2UgYWpheFwiPiR7dmFsdWV9PC9kaXY+YCk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRpZiAocmVzcG9uc2Uuc3VjY2Vzcykgd2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO1xuXHRcdFx0fSxcblxuXHRcdFx0b25GYWlsdXJlKHJlc3BvbnNlKSB7XG5cdFx0XHRcdCQodGhpcykucmVtb3ZlQ2xhc3MoJ2xvYWRpbmcgZGlzYWJsZWQnKTtcblx0XHRcdFx0JCgnZm9ybScpLmFmdGVyKHJlc3BvbnNlKTtcblx0XHRcdH0sXG5cdFx0fSk7XG5cblx0XHQvLyDQntGH0LjRgdGC0LrQsCDQvdCw0YHRgtGA0L7QtdC6INC00L7Qv9C+0LvQvdC40YLQtdC70YzQvdC+0LPQviDRgdC10YLQtdCy0L7Qs9C+XG5cdFx0JCgnLmRlbGV0ZS1pbnRlcmZhY2UtbmV3Jykub24oJ2NsaWNrJywgKCkgPT4ge1xuXHRcdFx0Y29uc3QgaW5pdGlhbFZhbHVlcyA9IHtcblx0XHRcdFx0aW50ZXJmYWNlX25ldzogJycsXG5cdFx0XHRcdG5hbWVfbmV3OiAnJyxcblx0XHRcdFx0ZGhjcF9uZXc6ICdvbicsXG5cdFx0XHRcdGlwYWRkcl9uZXc6ICcnLFxuXHRcdFx0XHRzdWJuZXRfbmV3OiAnMCcsXG5cdFx0XHR9O1xuXHRcdFx0bmV0d29ya3MuJGZvcm1PYmouZm9ybSgnc2V0IHZhbHVlcycsIGluaXRpYWxWYWx1ZXMpO1xuXHRcdFx0JCgnI2ludGVyZmFjZV9uZXcnKS5kcm9wZG93bigncmVzdG9yZSBkZWZhdWx0cycpO1xuXHRcdFx0JCgnI2RoY3AtbmV3LWNoZWNrYm94JykuY2hlY2tib3goJ2NoZWNrJyk7XG5cdFx0XHQkKCcjZXRoLWludGVyZmFjZXMtbWVudSAuaXRlbScpLnRhYignY2hhbmdlIHRhYicsICQoJyNldGgtaW50ZXJmYWNlcy1tZW51IGEuaXRlbScpLmZpcnN0KCkuYXR0cignZGF0YS10YWInKSk7XG5cdFx0fSk7XG5cblx0XHRuZXR3b3Jrcy5pbml0aWFsaXplRm9ybSgpO1xuXHR9LFxuXHQvKipcblx0ICog0J7QsdGA0LDQsdC+0YLRh9C40LogQVBJINGE0YPQvdC60YbQuNC4INC/0L4g0LLQvtC30LLRgNCw0YLRgyDRgdGC0YDRg9C60YLRg9GA0Ysg0YEgSVAg0LDQtNGA0LXRgdC+0Lwg0LzQsNGA0YjRgNGD0YLQuNC30LDRgtC+0YDQsFxuXHQgKi9cblx0Y2JBZnRlckdldEV4dGVybmFsSXAocmVzcG9uc2UpIHtcblx0XHRpZiAocmVzcG9uc2UgPT09IGZhbHNlKSB7XG5cdFx0XHRuZXR3b3Jrcy4kZ2V0TXlJcEJ1dHRvbi5yZW1vdmVDbGFzcygnbG9hZGluZyBkaXNhYmxlZCcpO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRuZXR3b3Jrcy4kZm9ybU9iai5mb3JtKCdzZXQgdmFsdWUnLCAnZXh0aXBhZGRyJywgcmVzcG9uc2UuaXApO1xuXHRcdFx0bmV0d29ya3MuJGdldE15SXBCdXR0b24ucmVtb3ZlQ2xhc3MoJ2xvYWRpbmcgZGlzYWJsZWQnKTtcblx0XHR9XG5cdH0sXG5cdHRvZ2dsZURpc2FibGVkRmllbGRDbGFzcygpIHtcblx0XHQkKCcjZXRoLWludGVyZmFjZXMtbWVudSBhJykuZWFjaCgoaW5kZXgsIG9iaikgPT4ge1xuXHRcdFx0Y29uc3QgZXRoID0gJChvYmopLmF0dHIoJ2RhdGEtdGFiJyk7XG5cdFx0XHRpZiAoJChgI2RoY3AtJHtldGh9LWNoZWNrYm94YCkuY2hlY2tib3goJ2lzIHVuY2hlY2tlZCcpKSB7XG5cdFx0XHRcdCQoYCNpcC1hZGRyZXNzLWdyb3VwLSR7ZXRofWApLnJlbW92ZUNsYXNzKCdkaXNhYmxlZCcpO1xuXHRcdFx0XHQkKGAjbm90LWRoY3AtJHtldGh9YCkudmFsKCcxJyk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHQkKGAjaXAtYWRkcmVzcy1ncm91cC0ke2V0aH1gKS5hZGRDbGFzcygnZGlzYWJsZWQnKTtcblx0XHRcdFx0JChgI25vdC1kaGNwLSR7ZXRofWApLnZhbCgnJyk7XG5cdFx0XHR9XG5cdFx0XHRuZXR3b3Jrcy5hZGROZXdGb3JtUnVsZXMoZXRoKTtcblx0XHR9KTtcblxuXHRcdGlmICgkKCcjdXNlbmF0LWNoZWNrYm94JykuY2hlY2tib3goJ2lzIGNoZWNrZWQnKSkge1xuXHRcdFx0JCgnLm5hdGVkLXNldHRpbmdzLWdyb3VwJykucmVtb3ZlQ2xhc3MoJ2Rpc2FibGVkJyk7XG5cdFx0fSBlbHNlIHtcblx0XHRcdCQoJy5uYXRlZC1zZXR0aW5ncy1ncm91cCcpLmFkZENsYXNzKCdkaXNhYmxlZCcpO1xuXHRcdH1cblx0fSxcblx0YWRkTmV3Rm9ybVJ1bGVzKG5ld1Jvd0lkKSB7XG5cdFx0Y29uc3QgbmFtZUNsYXNzID0gYG5hbWVfJHtuZXdSb3dJZH1gO1xuXHRcdG5ldHdvcmtzLnZhbGlkYXRlUnVsZXNbbmFtZUNsYXNzXSA9IHtcblx0XHRcdGlkZW50aWZpZXI6IG5hbWVDbGFzcyxcblx0XHRcdGRlcGVuZHM6IGBpbnRlcmZhY2VfJHtuZXdSb3dJZH1gLFxuXHRcdFx0cnVsZXM6IFtcblx0XHRcdFx0e1xuXHRcdFx0XHRcdHR5cGU6ICdlbXB0eScsXG5cdFx0XHRcdFx0cHJvbXB0OiBnbG9iYWxUcmFuc2xhdGUubndfVmFsaWRhdGVOYW1lSXNOb3RCZUVtcHR5LFxuXHRcdFx0XHR9LFxuXHRcdFx0XSxcblxuXHRcdH07XG5cblx0XHRjb25zdCB2bGFuQ2xhc3MgPSBgdmxhbmlkXyR7bmV3Um93SWR9YDtcblx0XHRuZXR3b3Jrcy52YWxpZGF0ZVJ1bGVzW3ZsYW5DbGFzc10gPSB7XG5cdFx0XHRkZXBlbmRzOiBgaW50ZXJmYWNlXyR7bmV3Um93SWR9YCxcblx0XHRcdGlkZW50aWZpZXI6IHZsYW5DbGFzcyxcblx0XHRcdHJ1bGVzOiBbXG5cdFx0XHRcdHtcblx0XHRcdFx0XHR0eXBlOiAnaW50ZWdlclswLi40MDk1XScsXG5cdFx0XHRcdFx0cHJvbXB0OiBnbG9iYWxUcmFuc2xhdGUubndfVmFsaWRhdGVWbGFuUmFuZ2UsXG5cdFx0XHRcdH0sXG5cdFx0XHRcdHtcblx0XHRcdFx0XHR0eXBlOiBgY2hlY2tWbGFuWyR7bmV3Um93SWR9XWAsXG5cdFx0XHRcdFx0cHJvbXB0OiBnbG9iYWxUcmFuc2xhdGUubndfVmFsaWRhdGVWbGFuQ3Jvc3MsXG5cdFx0XHRcdH0sXG5cdFx0XHRdLFxuXG5cdFx0fTtcblxuXHRcdGNvbnN0IGlwYWRkckNsYXNzID0gYGlwYWRkcl8ke25ld1Jvd0lkfWA7XG5cdFx0bmV0d29ya3MudmFsaWRhdGVSdWxlc1tpcGFkZHJDbGFzc10gPSB7XG5cdFx0XHRpZGVudGlmaWVyOiBpcGFkZHJDbGFzcyxcblx0XHRcdGRlcGVuZHM6IGBub3QtZGhjcC0ke25ld1Jvd0lkfWAsXG5cdFx0XHRydWxlczogW1xuXHRcdFx0XHR7XG5cdFx0XHRcdFx0dHlwZTogJ2VtcHR5Jyxcblx0XHRcdFx0XHRwcm9tcHQ6IGdsb2JhbFRyYW5zbGF0ZS5ud19WYWxpZGF0ZUlwcGFkZHJJc0VtcHR5LFxuXHRcdFx0XHR9LFxuXHRcdFx0XHR7XG5cdFx0XHRcdFx0dHlwZTogJ2lwYWRkcicsXG5cdFx0XHRcdFx0cHJvbXB0OiBnbG9iYWxUcmFuc2xhdGUubndfVmFsaWRhdGVJcHBhZGRyTm90UmlnaHQsXG5cdFx0XHRcdH0sXG5cdFx0XHRdLFxuXHRcdH07XG5cblx0XHRjb25zdCBkaGNwQ2xhc3MgPSBgZGhjcF8ke25ld1Jvd0lkfWA7XG5cdFx0bmV0d29ya3MudmFsaWRhdGVSdWxlc1tkaGNwQ2xhc3NdID0ge1xuXHRcdFx0aWRlbnRpZmllcjogZGhjcENsYXNzLFxuXHRcdFx0ZGVwZW5kczogYGludGVyZmFjZV8ke25ld1Jvd0lkfWAsXG5cdFx0XHRydWxlczogW1xuXHRcdFx0XHR7XG5cdFx0XHRcdFx0dHlwZTogYGRoY3BPblZsYW5OZXR3b3Jrc1ske25ld1Jvd0lkfV1gLFxuXHRcdFx0XHRcdHByb21wdDogZ2xvYmFsVHJhbnNsYXRlLm53X1ZhbGlkYXRlREhDUE9uVmxhbnNEb250U3VwcG9ydCxcblx0XHRcdFx0fSxcblx0XHRcdF0sXG5cdFx0fTtcblxuXHR9LFxuXHRjYkJlZm9yZVNlbmRGb3JtKHNldHRpbmdzKSB7XG5cdFx0Y29uc3QgcmVzdWx0ID0gc2V0dGluZ3M7XG5cdFx0cmVzdWx0LmRhdGEgPSBuZXR3b3Jrcy4kZm9ybU9iai5mb3JtKCdnZXQgdmFsdWVzJyk7XG5cdFx0cmV0dXJuIHJlc3VsdDtcblx0fSxcblx0Y2JBZnRlclNlbmRGb3JtKCkge1xuXG5cdH0sXG5cdGluaXRpYWxpemVGb3JtKCkge1xuXHRcdEZvcm0uJGZvcm1PYmogPSBuZXR3b3Jrcy4kZm9ybU9iajtcblx0XHRGb3JtLnVybCA9IGAke2dsb2JhbFJvb3RVcmx9bmV0d29yay9zYXZlYDtcblx0XHRGb3JtLnZhbGlkYXRlUnVsZXMgPSBuZXR3b3Jrcy52YWxpZGF0ZVJ1bGVzO1xuXHRcdEZvcm0uY2JCZWZvcmVTZW5kRm9ybSA9IG5ldHdvcmtzLmNiQmVmb3JlU2VuZEZvcm07XG5cdFx0Rm9ybS5jYkFmdGVyU2VuZEZvcm0gPSBuZXR3b3Jrcy5jYkFmdGVyU2VuZEZvcm07XG5cdFx0Rm9ybS5pbml0aWFsaXplKCk7XG5cdH0sXG59O1xuXG4kLmZuLmZvcm0uc2V0dGluZ3MucnVsZXMuaXBhZGRyID0gKHZhbHVlKSA9PiB7XG5cdGxldCByZXN1bHQgPSB0cnVlO1xuXHRjb25zdCBmID0gdmFsdWUubWF0Y2goL14oXFxkezEsM30pXFwuKFxcZHsxLDN9KVxcLihcXGR7MSwzfSlcXC4oXFxkezEsM30pJC8pO1xuXHRpZiAoZiA9PSBudWxsKSB7XG5cdFx0cmVzdWx0ID0gZmFsc2U7XG5cdH0gZWxzZSB7XG5cdFx0Zm9yIChsZXQgaSA9IDE7IGkgPCA1OyBpICs9IDEpIHtcblx0XHRcdGNvbnN0IGEgPSBmW2ldO1xuXHRcdFx0aWYgKGEgPiAyNTUpIHtcblx0XHRcdFx0cmVzdWx0ID0gZmFsc2U7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdGlmIChmWzVdID4gMzIpIHtcblx0XHRcdHJlc3VsdCA9IGZhbHNlO1xuXHRcdH1cblx0fVxuXHRyZXR1cm4gcmVzdWx0O1xufTtcblxuJC5mbi5mb3JtLnNldHRpbmdzLnJ1bGVzLmlwYWRkcldpdGhQb3J0T3B0aW9uYWwgPSAodmFsdWUpID0+IHtcblx0bGV0IHJlc3VsdCA9IHRydWU7XG5cdGNvbnN0IGYgPSB2YWx1ZS5tYXRjaCgvXihcXGR7MSwzfSlcXC4oXFxkezEsM30pXFwuKFxcZHsxLDN9KVxcLihcXGR7MSwzfSkoOlswLTldKyk/JC8pO1xuXHRpZiAoZiA9PSBudWxsKSB7XG5cdFx0cmVzdWx0ID0gZmFsc2U7XG5cdH0gZWxzZSB7XG5cdFx0Zm9yIChsZXQgaSA9IDE7IGkgPCA1OyBpICs9IDEpIHtcblx0XHRcdGNvbnN0IGEgPSBmW2ldO1xuXHRcdFx0aWYgKGEgPiAyNTUpIHtcblx0XHRcdFx0cmVzdWx0ID0gZmFsc2U7XG5cdFx0XHR9XG5cdFx0fVxuXHRcdGlmIChmWzVdID4gMzIpIHtcblx0XHRcdHJlc3VsdCA9IGZhbHNlO1xuXHRcdH1cblx0fVxuXHRyZXR1cm4gcmVzdWx0O1xufTtcblxuJC5mbi5mb3JtLnNldHRpbmdzLnJ1bGVzLmNoZWNrVmxhbiA9ICh2bGFuVmFsdWUsIHBhcmFtKSA9PiB7XG5cdGxldCByZXN1bHQgPSB0cnVlO1xuXHRjb25zdCB2bGFuc0FycmF5ID0ge307XG5cdGNvbnN0IGFsbFZhbHVlcyA9IG5ldHdvcmtzLiRmb3JtT2JqLmZvcm0oJ2dldCB2YWx1ZXMnKTtcblx0aWYgKGFsbFZhbHVlcy5pbnRlcmZhY2VfbmV3ICE9PSB1bmRlZmluZWQgJiYgYWxsVmFsdWVzLmludGVyZmFjZV9uZXcgPiAwKSB7XG5cdFx0Y29uc3QgbmV3RXRoTmFtZSA9IGFsbFZhbHVlc1tgaW50ZXJmYWNlXyR7YWxsVmFsdWVzLmludGVyZmFjZV9uZXd9YF07XG5cdFx0dmxhbnNBcnJheVtuZXdFdGhOYW1lXSA9IFthbGxWYWx1ZXMudmxhbmlkX25ld107XG5cdFx0aWYgKGFsbFZhbHVlcy52bGFuaWRfbmV3ID09PSAnJykge1xuXHRcdFx0cmVzdWx0ID0gZmFsc2U7XG5cdFx0fVxuXHR9XG5cdCQuZWFjaChhbGxWYWx1ZXMsIChpbmRleCwgdmFsdWUpID0+IHtcblx0XHRpZiAoaW5kZXggPT09ICdpbnRlcmZhY2VfbmV3JyB8fCBpbmRleCA9PT0gJ3ZsYW5pZF9uZXcnKSByZXR1cm47XG5cdFx0aWYgKGluZGV4LmluZGV4T2YoJ3ZsYW5pZCcpID49IDApIHtcblx0XHRcdGNvbnN0IGV0aE5hbWUgPSBhbGxWYWx1ZXNbYGludGVyZmFjZV8ke2luZGV4LnNwbGl0KCdfJylbMV19YF07XG5cdFx0XHRpZiAoJC5pbkFycmF5KHZhbHVlLCB2bGFuc0FycmF5W2V0aE5hbWVdKSA+PSAwXG5cdFx0XHRcdCYmIHZsYW5WYWx1ZSA9PT0gdmFsdWVcblx0XHRcdFx0JiYgcGFyYW0gPT09IGluZGV4LnNwbGl0KCdfJylbMV0pIHtcblx0XHRcdFx0cmVzdWx0ID0gZmFsc2U7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRpZiAoIShldGhOYW1lIGluIHZsYW5zQXJyYXkpKSB7XG5cdFx0XHRcdFx0dmxhbnNBcnJheVtldGhOYW1lXSA9IFtdO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHZsYW5zQXJyYXlbZXRoTmFtZV0ucHVzaCh2YWx1ZSk7XG5cdFx0XHR9XG5cdFx0fVxuXHR9KTtcblx0cmV0dXJuIHJlc3VsdDtcbn07XG5cbiQuZm4uZm9ybS5zZXR0aW5ncy5ydWxlcy5kaGNwT25WbGFuTmV0d29ya3MgPSAodmFsdWUsIHBhcmFtKSA9PiB7XG5cdGxldCByZXN1bHQgPSB0cnVlO1xuXHRjb25zdCB2bGFuVmFsdWUgPSBuZXR3b3Jrcy4kZm9ybU9iai5mb3JtKCdnZXQgdmFsdWUnLCBgdmxhbmlkXyR7cGFyYW19YCk7XG5cdGNvbnN0IGRoY3BWYWx1ZSA9IG5ldHdvcmtzLiRmb3JtT2JqLmZvcm0oJ2dldCB2YWx1ZScsIGBkaGNwXyR7cGFyYW19YCk7XG5cdGlmICh2bGFuVmFsdWUgPiAwICYmIGRoY3BWYWx1ZSA9PT0gJ29uJykge1xuXHRcdHJlc3VsdCA9IGZhbHNlO1xuXHR9XG5cdHJldHVybiByZXN1bHQ7XG59O1xuXG4kLmZuLmZvcm0uc2V0dGluZ3MucnVsZXMuZXh0ZW5hbElwSG9zdCA9ICgpID0+IHtcblx0Y29uc3QgYWxsVmFsdWVzID0gbmV0d29ya3MuJGZvcm1PYmouZm9ybSgnZ2V0IHZhbHVlcycpO1xuXHRpZiAoYWxsVmFsdWVzLnVzZW5hdCA9PT0gJ29uJykge1xuXHRcdGlmIChhbGxWYWx1ZXMuZXh0aG9zdG5hbWUgPT09ICcnICYmIGFsbFZhbHVlcy5leHRpcGFkZHIgPT09ICcnKSB7XG5cdFx0XHRyZXR1cm4gZmFsc2U7XG5cdFx0fVxuXHR9XG5cdHJldHVybiB0cnVlO1xufTtcblxuJChkb2N1bWVudCkucmVhZHkoKCkgPT4ge1xuXHRuZXR3b3Jrcy5pbml0aWFsaXplKCk7XG59KTtcbiJdfQ==